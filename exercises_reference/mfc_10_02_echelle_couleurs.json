{
  "id": "mfc_10_02_echelle_couleurs",
  "version": "1.0",
  "titre": "üåà MFC : visualiser les stocks avec des couleurs",

  "metadata": {
    "niveau": "debutant",
    "duree_estimee": "10 min",
    "competences_ids": [10],
    "competences_noms": ["Mise en forme conditionnelle simple"],
    "prerequis": [1, 2],
    "objectif_pedagogique": "Appliquer une √©chelle de couleurs (d√©grad√©) pour visualiser des valeurs relatives",
    "source_pdf": "Chapter 27: Conditional formatting - Section 27.1 (xlColorScale)",
    "requires_screenshot": true
  },

  "contexte": {
    "situation": "Tu g√®res le stock d'une boutique de pi√®ces d√©tach√©es. Tu veux voir d'un coup d'≈ìil quels produits sont en rupture imminente (rouge) et lesquels sont bien approvisionn√©s (vert).",
    
    "personnage": "Toi, responsable logistique chez AutoPi√®ces.",
    
    "objectif": "Appliquer un d√©grad√© rouge-jaune-vert qui colore automatiquement chaque cellule selon le niveau de stock.",
    
    "motivation": "L'√©chelle de couleurs transforme un tableau de chiffres en heatmap intuitive. Plus besoin de chercher les petits nombres !",
    
    "ton": "Le d√©grad√©, c'est comme un thermom√®tre visuel : du froid (rouge = danger) au chaud (vert = OK)."
  },

  "histoire_des_donnees": {
    "description": "Niveaux de stock de 8 r√©f√©rences de pi√®ces d√©tach√©es automobiles.",
    "periode": "Stock au 15 janvier 2025",
    "source_fictive": "Inventaire AutoPi√®ces"
  },

  "donnees": {
    "headers": ["R√©f√©rence", "Produit", "Stock"],
    "rows": [
      ["REF001", "Filtre √† huile", 45],
      ["REF002", "Plaquettes frein", 8],
      ["REF003", "Courroie distribution", 22],
      ["REF004", "Bougies (x4)", 67],
      ["REF005", "Amortisseur avant", 5],
      ["REF006", "Disque de frein", 31],
      ["REF007", "Batterie 12V", 12],
      ["REF008", "Phare LED", 3]
    ],
    "placement": {
      "start_cell": "A1",
      "headers_row": 1
    }
  },

  "etapes": [
    {
      "numero": 1,
      "titre": "S√©lectionner les stocks",
      "consigne": "S√©lectionne C2:C9 (les quantit√©s en stock).",
      "temps": "1 min"
    },
    {
      "numero": 2,
      "titre": "Appliquer l'√©chelle de couleurs",
      "consigne": "Accueil > Mise en forme conditionnelle > √âchelles de couleurs > √âchelle Rouge-Jaune-Vert.",
      "aide_contextuelle": "C'est la premi√®re √©chelle √† 3 couleurs dans le menu. Rouge = bas, Vert = √©lev√©.",
      "temps": "2 min"
    },
    {
      "numero": 3,
      "titre": "V√©rifier le r√©sultat",
      "description": "Les cellules les plus basses (3, 5, 8) doivent √™tre rouge√¢tres, les plus hautes (45, 67) verd√¢tres.",
      "consigne": "V√©rifie que le d√©grad√© va bien du rouge (faibles stocks) au vert (stocks √©lev√©s).",
      "aide_contextuelle": "Excel calcule automatiquement le d√©grad√© entre le min (3) et le max (67).",
      "temps": "1 min"
    },
    {
      "numero": 4,
      "titre": "Comprendre le calcul",
      "description": "Excel attribue rouge au minimum, vert au maximum, et jaune √† la m√©diane.",
      "consigne": "Note que les valeurs interm√©diaires (22, 31) sont jaun√¢tres/orang√©es.",
      "action_requise": false,
      "temps": "1 min"
    }
  ],

  "zone_travail": {
    "description": "√âchelle de couleurs sur la colonne Stock",
    "structure": [
      { "cellule": "A1:C9", "label": "Donn√©es", "style": "data" },
      { "cellule": "C2:C9", "label": "Zone MFC", "style": "mfc_zone" }
    ]
  },

  "checkpoints": [
    {
      "id": "cp_scale_1",
      "type": "format",
      "subtype": "mfc_color_scale",
      "description": "√âchelle de couleurs 3 points appliqu√©e",
      "competence_id": 10,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "mfc_detected": true,
        "rule_type": "color_scale",
        "scale_type": "3-color",
        "colors": ["red", "yellow", "green"]
      },
      "points": 40,
      "indices": [
        "Tu dois utiliser une √©chelle de couleurs, pas une r√®gle 'Sup√©rieur √†'.",
        "Accueil > MFC > √âchelles de couleurs > Rouge-Jaune-Vert",
        "Le d√©grad√© doit √™tre automatique sur toute la plage."
      ],
      "erreurs_probables": [
        { "type": "wrong_rule_type", "message": "Tu as appliqu√© une r√®gle simple, pas une √©chelle de couleurs. Choisis '√âchelles de couleurs' dans le menu." },
        { "type": "2_color_scale", "message": "Tu as une √©chelle √† 2 couleurs. Choisis celle √† 3 couleurs (rouge-jaune-vert)." }
      ]
    },
    {
      "id": "cp_scale_2",
      "type": "format",
      "subtype": "mfc_gradient",
      "description": "D√©grad√© correct (rouge=bas, vert=haut)",
      "competence_id": 10,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "min_color": "red",
        "max_color": "green",
        "mid_color": "yellow"
      },
      "points": 30,
      "indices": [
        "Les petites valeurs (3, 5, 8) doivent √™tre rouges/oranges.",
        "Les grandes valeurs (45, 67) doivent √™tre vertes.",
        "Si c'est l'inverse, tu as choisi l'√©chelle Vert-Rouge."
      ],
      "erreurs_probables": [
        { "type": "inverted_scale", "message": "L'√©chelle est invers√©e (vert pour les petites valeurs). Choisis Rouge-Jaune-Vert, pas Vert-Jaune-Rouge." }
      ]
    },
    {
      "id": "cp_scale_3",
      "type": "format",
      "subtype": "mfc_range",
      "description": "MFC sur la bonne plage",
      "competence_id": 10,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "range": "C2:C9",
        "excludes_header": true
      },
      "points": 15,
      "indices": [
        "La MFC doit √™tre uniquement sur C2:C9.",
        "L'en-t√™te 'Stock' ne doit pas √™tre color√©."
      ]
    },
    {
      "id": "cp_scale_4",
      "type": "format",
      "subtype": "mfc_visual",
      "description": "Visualisation claire des stocks critiques",
      "competence_id": 10,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "critical_items_red": ["REF005", "REF008"],
        "healthy_items_green": ["REF001", "REF004"]
      },
      "points": 15,
      "indices": [
        "REF005 (5) et REF008 (3) doivent √™tre clairement rouges.",
        "REF001 (45) et REF004 (67) doivent √™tre clairement verts.",
        "Les autres doivent √™tre dans les teintes interm√©diaires."
      ]
    }
  ],

  "solution_complete": {
    "description": "√âchelle de couleurs Rouge-Jaune-Vert sur C2:C9. Les stocks bas sont rouges, les stocks √©lev√©s sont verts.",
    "etapes_cles": [
      "S√©lection C2:C9",
      "Accueil > MFC > √âchelles de couleurs",
      "Choisir Rouge-Jaune-Vert"
    ]
  },

  "feedback_personnalise": {
    "parfait": "üéâ Parfait ! Tu vois imm√©diatement que REF005 et REF008 sont en rupture imminente. L'√©chelle de couleurs, c'est la base de la data visualization !",
    "bien": "üëç Tr√®s bien ! L'√©chelle est appliqu√©e. V√©rifie que le rouge correspond bien aux stocks bas.",
    "ameliorer": "üåà Presque ! Assure-toi d'utiliser une √©chelle de couleurs (d√©grad√©), pas une r√®gle simple.",
    "revoir": "üîÑ Recommence : MFC > √âchelles de couleurs > Rouge-Jaune-Vert. Tu dois voir un d√©grad√© progressif."
  },

  "pour_aller_plus_loin": [
    "Personnalise les seuils : rouge si < 10, jaune si < 30, vert sinon.",
    "Essaie l'√©chelle Vert-Blanc-Rouge (invers√©e).",
    "Applique une √©chelle 2 couleurs (Rouge-Vert sans jaune)."
  ]
}
