{
  "id": "mfc_25_01_top3",
  "version": "1.0",
  "titre": "üèÜ MFC avanc√©e : mettre en √©vidence le Top 3",

  "metadata": {
    "niveau": "intermediaire",
    "duree_estimee": "12 min",
    "competences_ids": [25],
    "competences_noms": ["MFC avanc√©e"],
    "prerequis": [10],
    "objectif_pedagogique": "Utiliser la r√®gle Top 10 pour mettre en surbrillance les N meilleures valeurs",
    "source_pdf": "Chapter 27: Conditional formatting - Section 27.4 (FormatConditions.AddTop10)",
    "requires_screenshot": true
  },

  "contexte": {
    "situation": "Tu pr√©pares la c√©r√©monie des awards de fin d'ann√©e chez RegionSales. Tu dois identifier les 3 r√©gions les plus performantes pour leur remettre un troph√©e.",
    
    "personnage": "Toi, responsable des ventes nationales.",
    
    "objectif": "Mettre automatiquement en dor√© les 3 meilleures r√©gions en termes de CA.",
    
    "motivation": "La r√®gle Top N est parfaite pour identifier les champions sans avoir √† trier les donn√©es.",
    
    "ton": "On passe au niveau sup√©rieur avec les r√®gles MFC avanc√©es !"
  },

  "histoire_des_donnees": {
    "description": "Chiffre d'affaires annuel par r√©gion commerciale.",
    "periode": "Ann√©e 2024",
    "source_fictive": "Consolidation r√©gionale"
  },

  "donnees": {
    "headers": ["R√©gion", "CA (k‚Ç¨)"],
    "rows": [
      ["Nord", 125],
      ["Sud", 98],
      ["Est", 142],
      ["Ouest", 87],
      ["Centre", 156],
      ["√éle-de-France", 201],
      ["PACA", 134],
      ["Bretagne", 76]
    ],
    "placement": {
      "start_cell": "A1",
      "headers_row": 1
    }
  },

  "etapes": [
    {
      "numero": 1,
      "titre": "S√©lectionner les CA",
      "consigne": "S√©lectionne B2:B9 (les chiffres d'affaires).",
      "temps": "1 min"
    },
    {
      "numero": 2,
      "titre": "Ouvrir la r√®gle Top 10",
      "consigne": "Accueil > MFC > R√®gles des valeurs plus/moins √©lev√©es > 10 valeurs les plus √©lev√©es...",
      "aide_contextuelle": "Malgr√© son nom, cette r√®gle permet de d√©finir N valeurs, pas forc√©ment 10.",
      "temps": "1 min"
    },
    {
      "numero": 3,
      "titre": "Configurer le Top 3",
      "consigne": "Dans la bo√Æte de dialogue, change '10' en '3'. Choisis un format dor√©/jaune.",
      "aide_contextuelle": "Tu peux mettre n'importe quel nombre. Top 3, Top 5, Top 1... √† toi de choisir.",
      "temps": "2 min"
    },
    {
      "numero": 4,
      "titre": "V√©rifier le r√©sultat",
      "description": "Les 3 plus gros CA doivent √™tre mis en √©vidence.",
      "consigne": "V√©rifie que √éle-de-France (201), Centre (156) et Est (142) sont color√©s.",
      "temps": "1 min"
    }
  ],

  "zone_travail": {
    "description": "MFC sur la colonne CA",
    "structure": [
      { "cellule": "A1:B9", "label": "Donn√©es", "style": "data" },
      { "cellule": "B2:B9", "label": "Zone MFC", "style": "mfc_zone" }
    ]
  },

  "checkpoints": [
    {
      "id": "cp_top_1",
      "type": "format",
      "subtype": "mfc_top10",
      "description": "R√®gle Top 3 appliqu√©e",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "mfc_detected": true,
        "rule_type": "top10",
        "count": 3,
        "type": "top"
      },
      "points": 40,
      "indices": [
        "Utilise 'R√®gles des valeurs plus/moins √©lev√©es > 10 valeurs les plus √©lev√©es'.",
        "Change le nombre de 10 √† 3 dans la bo√Æte de dialogue.",
        "C'est bien 'plus √©lev√©es', pas 'moins √©lev√©es'."
      ],
      "erreurs_probables": [
        { "type": "wrong_count", "message": "Tu as laiss√© 10 au lieu de 3. Modifie le nombre." },
        { "type": "bottom_instead", "message": "Tu as s√©lectionn√© 'moins √©lev√©es' au lieu de 'plus √©lev√©es'." }
      ]
    },
    {
      "id": "cp_top_2",
      "type": "format",
      "subtype": "mfc_color",
      "description": "Format dor√©/jaune appliqu√©",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "fill_color": "gold",
        "fill_color_variants": ["dor√©", "gold", "yellow", "jaune", "orange"]
      },
      "points": 20,
      "indices": [
        "Choisis un format qui √©voque le podium : dor√©, jaune ou orange.",
        "Tu peux personnaliser via 'Format personnalis√©'."
      ]
    },
    {
      "id": "cp_top_3",
      "type": "format",
      "subtype": "mfc_coverage",
      "description": "Exactement 3 cellules color√©es",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "colored_cells_count": 3,
        "colored_values": [201, 156, 142],
        "colored_regions": ["√éle-de-France", "Centre", "Est"]
      },
      "points": 30,
      "indices": [
        "Seuls √éle-de-France (201), Centre (156) et Est (142) doivent √™tre color√©s.",
        "Les 5 autres r√©gions ne doivent PAS √™tre color√©es.",
        "Si plus de 3 sont color√©es, v√©rifie ton param√®tre."
      ]
    },
    {
      "id": "cp_top_4",
      "type": "format",
      "subtype": "mfc_range",
      "description": "MFC sur la bonne plage",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "range": "B2:B9"
      },
      "points": 10
    }
  ],

  "solution_complete": {
    "description": "R√®gle 'Top 3' avec format dor√© sur B2:B9. √éle-de-France, Centre et Est sont mis en √©vidence.",
    "etapes_cles": [
      "S√©lection B2:B9",
      "MFC > Valeurs plus √©lev√©es > Top 10",
      "Modifier 10 ‚Üí 3",
      "Format dor√©"
    ]
  },

  "feedback_personnalise": {
    "parfait": "üèÜ Parfait ! Les 3 champions r√©gionaux sont identifi√©s. Pr√©pare les troph√©es !",
    "bien": "üëç Tr√®s bien ! La r√®gle fonctionne. V√©rifie que seules 3 cellules sont color√©es.",
    "ameliorer": "ü•á Presque ! Assure-toi d'utiliser 'Top 3', pas 'Top 10'.",
    "revoir": "üîÑ Recommence : MFC > Valeurs plus √©lev√©es > change 10 en 3."
  },

  "pour_aller_plus_loin": [
    "Ajoute une 2√®me r√®gle pour le Bottom 3 (en rouge).",
    "Utilise 'Top 10%' au lieu de 'Top 3' pour les grandes listes.",
    "Combine avec une √©chelle de couleurs pour voir la distribution compl√®te."
  ]
}
