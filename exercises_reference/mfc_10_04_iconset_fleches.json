{
  "id": "mfc_10_04_iconset_fleches",
  "version": "1.0",
  "titre": "‚¨ÜÔ∏è MFC : fl√®ches pour indiquer la tendance",

  "metadata": {
    "niveau": "intermediaire",
    "duree_estimee": "15 min",
    "competences_ids": [10],
    "competences_noms": ["Mise en forme conditionnelle simple"],
    "prerequis": [1, 2],
    "objectif_pedagogique": "Utiliser les jeux d'ic√¥nes pour repr√©senter visuellement des tendances ou cat√©gories",
    "source_pdf": "Chapter 27: Conditional formatting - Section 27.6 (xlIconSet)",
    "requires_screenshot": true
  },

  "contexte": {
    "situation": "Tu pr√©sentes les r√©sultats mensuels au comit√© de direction. Ils veulent voir d'un coup d'≈ìil si chaque indicateur est en hausse, stable ou en baisse par rapport au mois dernier.",
    
    "personnage": "Toi, contr√¥leur de gestion pr√©sentant le tableau de bord mensuel.",
    
    "objectif": "Ajouter des fl√®ches qui indiquent automatiquement la tendance : ‚¨ÜÔ∏è hausse, ‚û°Ô∏è stable, ‚¨áÔ∏è baisse.",
    
    "motivation": "Les ic√¥nes remplacent des mots par des symboles universels. M√™me sans lire les chiffres, on comprend la situation.",
    
    "ton": "Les ic√¥nes, c'est le langage universel du business dashboard !"
  },

  "histoire_des_donnees": {
    "description": "Variation (%) des KPIs par rapport au mois pr√©c√©dent. Positif = hausse, n√©gatif = baisse.",
    "periode": "Janvier 2025 vs D√©cembre 2024",
    "source_fictive": "Dashboard mensuel"
  },

  "donnees": {
    "headers": ["Indicateur", "Variation (%)"],
    "rows": [
      ["Chiffre d'affaires", 8],
      ["Marge brute", 3],
      ["Co√ªts fixes", -2],
      ["Nouveaux clients", 15],
      ["R√©clamations", -12],
      ["D√©lai livraison (jours)", 1],
      ["Satisfaction client", 0],
      ["Turnover", -5]
    ],
    "placement": {
      "start_cell": "A1",
      "headers_row": 1
    }
  },

  "etapes": [
    {
      "numero": 1,
      "titre": "S√©lectionner les variations",
      "consigne": "S√©lectionne B2:B9 (les pourcentages de variation).",
      "temps": "1 min"
    },
    {
      "numero": 2,
      "titre": "Appliquer le jeu d'ic√¥nes",
      "consigne": "Accueil > Mise en forme conditionnelle > Jeux d'ic√¥nes > Fl√®ches (3 fl√®ches color√©es).",
      "aide_contextuelle": "Choisis les 3 fl√®ches : verte haut ‚¨ÜÔ∏è, jaune droite ‚û°Ô∏è, rouge bas ‚¨áÔ∏è.",
      "temps": "2 min"
    },
    {
      "numero": 3,
      "titre": "Comprendre le probl√®me",
      "description": "Par d√©faut, Excel r√©partit les ic√¥nes sur les percentiles (tiers). Ce n'est pas ce qu'on veut.",
      "consigne": "Tu verras que la r√©partition n'est pas logique. On va personnaliser.",
      "action_requise": false,
      "temps": "1 min"
    },
    {
      "numero": 4,
      "titre": "Personnaliser les seuils",
      "description": "On veut : ‚¨ÜÔ∏è si > 0, ‚û°Ô∏è si = 0, ‚¨áÔ∏è si < 0.",
      "consigne": "Accueil > MFC > G√©rer les r√®gles > Modifier la r√®gle. Change les seuils : Vert >= 1, Jaune >= 0, Rouge < 0. Type : Nombre (pas pourcentage).",
      "aide_contextuelle": "En mettant Vert >= 1 et Jaune >= 0, tu obtiens : positif = vert, z√©ro = jaune, n√©gatif = rouge.",
      "temps": "4 min"
    },
    {
      "numero": 5,
      "titre": "V√©rifier le r√©sultat",
      "description": "Les variations positives doivent avoir une fl√®che verte, les n√©gatives une rouge, et z√©ro une jaune.",
      "consigne": "CA (+8%), Marge (+3%), Nouveaux clients (+15%), D√©lai (+1%) = ‚¨ÜÔ∏è vert. Co√ªts (-2%), R√©clamations (-12%), Turnover (-5%) = ‚¨áÔ∏è rouge. Satisfaction (0%) = ‚û°Ô∏è jaune.",
      "temps": "2 min"
    }
  ],

  "zone_travail": {
    "description": "Ic√¥nes sur la colonne Variation",
    "structure": [
      { "cellule": "A1:B9", "label": "Donn√©es", "style": "data" },
      { "cellule": "B2:B9", "label": "Zone MFC", "style": "mfc_zone" }
    ]
  },

  "checkpoints": [
    {
      "id": "cp_icon_1",
      "type": "format",
      "subtype": "mfc_iconset",
      "description": "Jeu d'ic√¥nes fl√®ches appliqu√©",
      "competence_id": 10,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "mfc_detected": true,
        "rule_type": "iconset",
        "iconset_type": "arrows",
        "icon_count": 3
      },
      "points": 30,
      "indices": [
        "Tu dois voir des fl√®ches (‚¨ÜÔ∏è‚û°Ô∏è‚¨áÔ∏è) √† c√¥t√© de chaque valeur.",
        "Accueil > MFC > Jeux d'ic√¥nes > 3 fl√®ches",
        "Les ic√¥nes peuvent √™tre color√©es ou non selon le jeu choisi."
      ],
      "erreurs_probables": [
        { "type": "wrong_iconset", "message": "Tu as utilis√© des feux tricolores ou des √©toiles au lieu des fl√®ches." },
        { "type": "no_icons", "message": "Pas d'ic√¥nes visibles. V√©rifie que tu as bien appliqu√© un jeu d'ic√¥nes." }
      ]
    },
    {
      "id": "cp_icon_2",
      "type": "format",
      "subtype": "mfc_iconset_thresholds",
      "description": "Seuils personnalis√©s (>0, =0, <0)",
      "competence_id": 10,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "green_threshold": "> 0",
        "yellow_threshold": "= 0",
        "red_threshold": "< 0",
        "thresholds_custom": true
      },
      "points": 35,
      "indices": [
        "Par d√©faut, Excel utilise des percentiles. Tu dois personnaliser.",
        "G√©rer les r√®gles > Modifier > Type : Nombre",
        "Vert si >= 1, Jaune si >= 0, Rouge sinon."
      ],
      "erreurs_probables": [
        { "type": "percentile_thresholds", "message": "Les seuils sont encore en pourcentile (33%, 67%). Change en 'Nombre' et mets des valeurs absolues." },
        { "type": "wrong_thresholds", "message": "Les valeurs positives ne sont pas toutes vertes ou les n√©gatives pas toutes rouges. V√©rifie tes seuils." }
      ]
    },
    {
      "id": "cp_icon_3",
      "type": "format",
      "subtype": "mfc_iconset_correct",
      "description": "Ic√¥nes correctement attribu√©es",
      "competence_id": 10,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "green_arrows": ["CA", "Marge", "Nouveaux clients", "D√©lai"],
        "yellow_arrows": ["Satisfaction"],
        "red_arrows": ["Co√ªts", "R√©clamations", "Turnover"]
      },
      "points": 25,
      "indices": [
        "4 indicateurs positifs ‚Üí ‚¨ÜÔ∏è vert (CA, Marge, Nouveaux clients, D√©lai)",
        "1 indicateur √† z√©ro ‚Üí ‚û°Ô∏è jaune (Satisfaction)",
        "3 indicateurs n√©gatifs ‚Üí ‚¨áÔ∏è rouge (Co√ªts, R√©clamations, Turnover)"
      ]
    },
    {
      "id": "cp_icon_4",
      "type": "format",
      "subtype": "mfc_range",
      "description": "MFC sur la bonne plage",
      "competence_id": 10,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "range": "B2:B9",
        "excludes_header": true
      },
      "points": 10,
      "indices": [
        "Les ic√¥nes doivent √™tre uniquement sur B2:B9.",
        "L'en-t√™te 'Variation (%)' ne doit pas avoir d'ic√¥ne."
      ]
    }
  ],

  "solution_complete": {
    "description": "Jeu d'ic√¥nes 3 fl√®ches color√©es sur B2:B9. Seuils personnalis√©s : vert >= 1, jaune >= 0, rouge < 0. 4 vertes, 1 jaune, 3 rouges.",
    "etapes_cles": [
      "S√©lection B2:B9",
      "MFC > Jeux d'ic√¥nes > 3 fl√®ches",
      "G√©rer les r√®gles > Modifier",
      "Seuils : Type Nombre, Vert >= 1, Jaune >= 0"
    ]
  },

  "feedback_personnalise": {
    "parfait": "üéâ Parfait ! Ton tableau de bord est pr√™t pour la pr√©sentation. Le comit√© voit instantan√©ment les tendances !",
    "bien": "üëç Tr√®s bien ! Les ic√¥nes sont l√†. V√©rifie que les seuils sont bien personnalis√©s (positif = vert, n√©gatif = rouge).",
    "ameliorer": "‚¨ÜÔ∏è Presque ! Les fl√®ches sont pr√©sentes mais la logique n'est pas bonne. Personnalise les seuils.",
    "revoir": "üîÑ Recommence : MFC > Jeux d'ic√¥nes > 3 fl√®ches, puis personnalise les seuils via 'G√©rer les r√®gles'."
  },

  "pour_aller_plus_loin": [
    "Masque les valeurs pour ne voir que les ic√¥nes (cocher 'Afficher l'ic√¥ne uniquement').",
    "Utilise 5 fl√®ches pour plus de granularit√© (forte hausse, hausse, stable, baisse, forte baisse).",
    "Inverse les couleurs pour les indicateurs o√π 'moins = mieux' (ex: co√ªts, r√©clamations)."
  ]
}
