{
  "id": "mfc_25_05_valeurs_uniques",
  "version": "1.0",
  "titre": "âœ¨ MFC avancÃ©e : identifier les valeurs uniques",

  "metadata": {
    "niveau": "intermediaire",
    "duree_estimee": "10 min",
    "competences_ids": [25],
    "competences_noms": ["MFC avancÃ©e"],
    "prerequis": [10],
    "objectif_pedagogique": "Utiliser la rÃ¨gle 'Valeurs uniques' pour identifier les Ã©lÃ©ments non rÃ©pÃ©tÃ©s",
    "source_pdf": "Chapter 27: Conditional formatting - Section 27.3 (FormatConditions.AddUniqueValues)",
    "requires_screenshot": true
  },

  "contexte": {
    "situation": "Tu analyses une liste de participants Ã  un tirage au sort. Tu veux identifier ceux qui n'ont jouÃ© qu'une seule fois pour leur accorder une chance supplÃ©mentaire.",
    
    "personnage": "Toi, organisateur d'un jeu-concours.",
    
    "objectif": "Mettre en bleu les emails qui n'apparaissent qu'une seule fois dans la liste.",
    
    "motivation": "L'inverse des doublons ! Parfois on cherche les Ã©lÃ©ments uniques plutÃ´t que les rÃ©pÃ©titions.",
    
    "ton": "Valeurs uniques vs doublons : deux faces de la mÃªme piÃ¨ce."
  },

  "histoire_des_donnees": {
    "description": "Liste de participations au jeu-concours avec des joueurs multi-participations.",
    "periode": "Janvier 2025",
    "source_fictive": "Formulaire inscription"
  },

  "donnees": {
    "headers": ["Email participant"],
    "rows": [
      ["alice@mail.com"],
      ["bob@mail.com"],
      ["claire@mail.com"],
      ["bob@mail.com"],
      ["david@mail.com"],
      ["emma@mail.com"],
      ["claire@mail.com"],
      ["fabien@mail.com"]
    ],
    "placement": {
      "start_cell": "A1",
      "headers_row": 1
    }
  },

  "etapes": [
    {
      "numero": 1,
      "titre": "SÃ©lectionner les emails",
      "consigne": "SÃ©lectionne A2:A9.",
      "temps": "1 min"
    },
    {
      "numero": 2,
      "titre": "Appliquer la rÃ¨gle Valeurs uniques",
      "consigne": "Accueil > MFC > RÃ¨gles de surbrillance > Valeurs en double... puis dans le menu dÃ©roulant, change 'En double' en 'Uniques'.",
      "aide_contextuelle": "La boÃ®te de dialogue permet de choisir entre 'En double' et 'Uniques'.",
      "temps": "2 min"
    },
    {
      "numero": 3,
      "titre": "Choisir un format bleu",
      "consigne": "SÃ©lectionne un format bleu clair pour marquer les valeurs uniques.",
      "temps": "1 min"
    },
    {
      "numero": 4,
      "titre": "VÃ©rifier le rÃ©sultat",
      "consigne": "alice, david, emma et fabien doivent Ãªtre colorÃ©s (4 valeurs uniques). bob et claire (doublons) ne doivent PAS Ãªtre colorÃ©s.",
      "temps": "1 min"
    }
  ],

  "checkpoints": [
    {
      "id": "cp_unique_1",
      "type": "format",
      "subtype": "mfc_unique_values",
      "description": "RÃ¨gle Valeurs uniques appliquÃ©e",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "mfc_detected": true,
        "rule_type": "unique",
        "type": "unique"
      },
      "points": 40,
      "indices": [
        "Dans la boÃ®te 'Valeurs en double', il y a un menu dÃ©roulant.",
        "Change 'En double' en 'Uniques'.",
        "Les valeurs uniques = celles qui n'apparaissent qu'UNE SEULE fois."
      ],
      "erreurs_probables": [
        { "type": "duplicate_instead", "message": "Tu as laissÃ© 'En double' au lieu de 'Uniques'. Change dans le menu dÃ©roulant." }
      ]
    },
    {
      "id": "cp_unique_2",
      "type": "format",
      "subtype": "mfc_coverage",
      "description": "4 valeurs uniques colorÃ©es",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "colored_cells_count": 4,
        "unique_emails": ["alice@mail.com", "david@mail.com", "emma@mail.com", "fabien@mail.com"],
        "not_colored": ["bob@mail.com", "claire@mail.com"]
      },
      "points": 40,
      "indices": [
        "4 emails n'apparaissent qu'une fois : alice, david, emma, fabien.",
        "bob et claire apparaissent 2 fois chacun â†’ doublons â†’ pas colorÃ©s.",
        "Si bob et claire sont colorÃ©s, tu as utilisÃ© 'En double' au lieu de 'Uniques'."
      ]
    },
    {
      "id": "cp_unique_3",
      "type": "format",
      "subtype": "mfc_color",
      "description": "Format bleu appliquÃ©",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "fill_color": "blue",
        "fill_color_variants": ["bleu", "blue", "lightblue", "cyan"]
      },
      "points": 20
    }
  ],

  "solution_complete": {
    "description": "MFC Valeurs uniques en bleu sur A2:A9. 4 emails uniques colorÃ©s.",
    "etapes_cles": [
      "SÃ©lection A2:A9",
      "MFC > Valeurs en double > changer en 'Uniques'",
      "Format bleu"
    ]
  },

  "feedback_personnalise": {
    "parfait": "ğŸ‰ Parfait ! Tu as identifiÃ© les 4 joueurs uniques. Ils mÃ©ritent leur chance bonus !",
    "bien": "ğŸ‘ Bien ! VÃ©rifie que SEULES les valeurs uniques sont colorÃ©es (pas les doublons).",
    "ameliorer": "âœ¨ Attention ! Tu as peut-Ãªtre colorÃ© les doublons au lieu des uniques.",
    "revoir": "ğŸ”„ Dans la boÃ®te de dialogue, cherche le menu dÃ©roulant et sÃ©lectionne 'Uniques' au lieu de 'En double'."
  }
}
