{
  "id": "mfc_25_03_doublons",
  "version": "1.0",
  "titre": "üîç MFC avanc√©e : traquer les doublons",

  "metadata": {
    "niveau": "intermediaire",
    "duree_estimee": "10 min",
    "competences_ids": [25],
    "competences_noms": ["MFC avanc√©e"],
    "prerequis": [10],
    "objectif_pedagogique": "Utiliser la r√®gle 'Valeurs en double' pour identifier les doublons dans une liste",
    "source_pdf": "Chapter 27: Conditional formatting - Section 27.3 (FormatConditions.AddUniqueValues)",
    "requires_screenshot": true
  },

  "contexte": {
    "situation": "Tu importes une liste de codes produits depuis un ancien syst√®me. Avant de l'int√©grer, tu dois v√©rifier qu'il n'y a pas de doublons qui pourraient causer des erreurs.",
    
    "personnage": "Toi, data analyst nettoyant des donn√©es.",
    
    "objectif": "Mettre en rouge tous les codes produits qui apparaissent plus d'une fois.",
    
    "motivation": "D√©tecter les doublons manuellement dans 1000 lignes ? Non merci. La MFC le fait en 2 clics.",
    
    "ton": "Le nettoyage de donn√©es, c'est 80% du travail d'un data analyst. Autant l'automatiser !"
  },

  "histoire_des_donnees": {
    "description": "Liste de codes produits import√©s avec des doublons accidentels.",
    "periode": "Import du 15/01/2025",
    "source_fictive": "Export ERP legacy"
  },

  "donnees": {
    "headers": ["Code Produit"],
    "rows": [
      ["PRD-001"],
      ["PRD-002"],
      ["PRD-003"],
      ["PRD-001"],
      ["PRD-004"],
      ["PRD-005"],
      ["PRD-002"],
      ["PRD-006"],
      ["PRD-003"],
      ["PRD-007"]
    ],
    "placement": {
      "start_cell": "A1",
      "headers_row": 1
    }
  },

  "etapes": [
    {
      "numero": 1,
      "titre": "S√©lectionner les codes",
      "consigne": "S√©lectionne A2:A11 (tous les codes produits).",
      "temps": "1 min"
    },
    {
      "numero": 2,
      "titre": "Appliquer la r√®gle doublons",
      "consigne": "Accueil > MFC > R√®gles de mise en surbrillance des cellules > Valeurs en double...",
      "aide_contextuelle": "Cette r√®gle d√©tecte automatiquement les valeurs qui apparaissent plus d'une fois.",
      "temps": "2 min"
    },
    {
      "numero": 3,
      "titre": "Choisir le format",
      "consigne": "Garde le format par d√©faut (rouge clair) ou personnalise en rouge vif.",
      "aide_contextuelle": "Le rouge signale un probl√®me √† corriger.",
      "temps": "1 min"
    },
    {
      "numero": 4,
      "titre": "Analyser les r√©sultats",
      "description": "Les doublons doivent √™tre identifi√©s.",
      "consigne": "V√©rifie que PRD-001 (lignes 2 et 5), PRD-002 (lignes 3 et 8), PRD-003 (lignes 4 et 10) sont en rouge.",
      "aide_contextuelle": "6 cellules sur 10 sont des doublons (3 paires).",
      "temps": "1 min"
    }
  ],

  "zone_travail": {
    "description": "MFC sur la colonne des codes",
    "structure": [
      { "cellule": "A1:A11", "label": "Donn√©es", "style": "data" },
      { "cellule": "A2:A11", "label": "Zone MFC", "style": "mfc_zone" }
    ]
  },

  "checkpoints": [
    {
      "id": "cp_dup_1",
      "type": "format",
      "subtype": "mfc_unique_values",
      "description": "R√®gle 'Valeurs en double' appliqu√©e",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "mfc_detected": true,
        "rule_type": "duplicate",
        "type": "duplicate"
      },
      "points": 40,
      "indices": [
        "Utilise 'Valeurs en double', pas 'Valeurs uniques'.",
        "Accueil > MFC > R√®gles de mise en surbrillance > Valeurs en double",
        "La r√®gle colore TOUTES les occurrences d'une valeur r√©p√©t√©e."
      ],
      "erreurs_probables": [
        { "type": "unique_instead", "message": "Tu as s√©lectionn√© 'Valeurs uniques' au lieu de 'Valeurs en double'." },
        { "type": "wrong_rule", "message": "Tu as utilis√© une autre r√®gle. Cherche 'Valeurs en double' dans le menu." }
      ]
    },
    {
      "id": "cp_dup_2",
      "type": "format",
      "subtype": "mfc_color",
      "description": "Format rouge appliqu√©",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "fill_color": "red",
        "fill_color_variants": ["rouge", "red", "lightred", "rouge clair", "pink"]
      },
      "points": 20,
      "indices": [
        "Le rouge indique un probl√®me/erreur.",
        "Le format par d√©faut est d√©j√† rouge clair."
      ]
    },
    {
      "id": "cp_dup_3",
      "type": "format",
      "subtype": "mfc_coverage",
      "description": "6 cellules color√©es (3 paires de doublons)",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "colored_cells_count": 6,
        "duplicate_values": ["PRD-001", "PRD-002", "PRD-003"],
        "unique_values_not_colored": ["PRD-004", "PRD-005", "PRD-006", "PRD-007"]
      },
      "points": 30,
      "indices": [
        "3 codes sont en double : PRD-001, PRD-002, PRD-003.",
        "Chaque doublon colore 2 cellules, donc 6 au total.",
        "PRD-004, 005, 006, 007 sont uniques et ne doivent PAS √™tre color√©s."
      ]
    },
    {
      "id": "cp_dup_4",
      "type": "format",
      "subtype": "mfc_range",
      "description": "MFC sur la bonne plage",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "range": "A2:A11"
      },
      "points": 10
    }
  ],

  "solution_complete": {
    "description": "R√®gle 'Valeurs en double' avec format rouge sur A2:A11. 6 cellules color√©es (3 paires de doublons).",
    "etapes_cles": [
      "S√©lection A2:A11",
      "MFC > Valeurs en double",
      "Format rouge (d√©faut)"
    ]
  },

  "feedback_personnalise": {
    "parfait": "üéâ Parfait ! Tu as d√©tect√© les 3 paires de doublons. Maintenant tu peux les nettoyer !",
    "bien": "üëç Tr√®s bien ! Les doublons sont identifi√©s. V√©rifie que seules les valeurs r√©p√©t√©es sont rouges.",
    "ameliorer": "üîç Presque ! Assure-toi d'utiliser 'Valeurs en double', pas 'Valeurs uniques'.",
    "revoir": "üîÑ Recommence : MFC > R√®gles de surbrillance > Valeurs en double."
  },

  "pour_aller_plus_loin": [
    "Utilise 'Supprimer les doublons' (onglet Donn√©es) pour nettoyer la liste.",
    "Ajoute 'Valeurs uniques' en vert pour voir les deux cat√©gories.",
    "Applique sur plusieurs colonnes pour d√©tecter les doublons multi-crit√®res."
  ]
}
