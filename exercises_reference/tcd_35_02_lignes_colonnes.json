{
  "id": "tcd_35_02_lignes_colonnes",
  "version": "1.0",
  "titre": "üìä TCD : croiser lignes et colonnes",

  "metadata": {
    "niveau": "intermediaire",
    "duree_estimee": "15 min",
    "competences_ids": [35],
    "competences_noms": ["Tableaux crois√©s dynamiques"],
    "prerequis": [35],
    "objectif_pedagogique": "Cr√©er un TCD avec deux dimensions : une en ligne et une en colonne",
    "source_pdf": "Chapter 13: Pivot Tables - Section 13.1",
    "requires_screenshot": true
  },

  "contexte": {
    "situation": "Le directeur r√©gional veut voir le CA par cat√©gorie ET par r√©gion. Un tableau √† double entr√©e serait parfait pour comparer d'un coup d'≈ìil.",
    
    "personnage": "Toi, contr√¥leur de gestion r√©gional.",
    
    "objectif": "Cr√©er un TCD qui croise cat√©gories (lignes) et r√©gions (colonnes).",
    
    "motivation": "Le croisement lignes/colonnes, c'est LA force du TCD. Un seul tableau remplace des dizaines de SOMME.SI.ENS !",
    
    "ton": "On monte d'un niveau. Le TCD √† double entr√©e, c'est du lourd."
  },

  "histoire_des_donnees": {
    "description": "Ventes par cat√©gorie et par r√©gion commerciale.",
    "periode": "Ann√©e 2024",
    "source_fictive": "Consolidation r√©gionale"
  },

  "donnees": {
    "headers": ["R√©gion", "Cat√©gorie", "CA (k‚Ç¨)"],
    "rows": [
      ["Nord", "√âlectronique", 85],
      ["Nord", "Mode", 62],
      ["Nord", "Maison", 41],
      ["Sud", "√âlectronique", 72],
      ["Sud", "Mode", 58],
      ["Sud", "Maison", 35],
      ["Est", "√âlectronique", 91],
      ["Est", "Mode", 48],
      ["Est", "Maison", 52],
      ["Ouest", "√âlectronique", 68],
      ["Ouest", "Mode", 71],
      ["Ouest", "Maison", 29]
    ],
    "placement": {
      "start_cell": "A1",
      "headers_row": 1
    }
  },

  "etapes": [
    {
      "numero": 1,
      "titre": "Cr√©er le TCD",
      "consigne": "Clic dans les donn√©es > Insertion > Tableau crois√© dynamique > Nouvelle feuille.",
      "temps": "2 min"
    },
    {
      "numero": 2,
      "titre": "Ajouter Cat√©gorie en lignes",
      "consigne": "Glisse 'Cat√©gorie' dans la zone 'Lignes'.",
      "temps": "1 min"
    },
    {
      "numero": 3,
      "titre": "Ajouter R√©gion en colonnes",
      "description": "C'est l√† que √ßa devient int√©ressant !",
      "consigne": "Glisse 'R√©gion' dans la zone 'Colonnes'.",
      "aide_contextuelle": "Tu vas obtenir un tableau avec Cat√©gories en lignes et R√©gions en colonnes.",
      "temps": "2 min"
    },
    {
      "numero": 4,
      "titre": "Ajouter CA en valeurs",
      "consigne": "Glisse 'CA (k‚Ç¨)' dans la zone 'Valeurs'.",
      "temps": "1 min"
    },
    {
      "numero": 5,
      "titre": "Analyser le r√©sultat",
      "description": "Tu obtiens une matrice cat√©gorie √ó r√©gion.",
      "consigne": "V√©rifie que tu vois 3 lignes (cat√©gories) √ó 4 colonnes (r√©gions) + totaux.",
      "aide_contextuelle": "√âlectronique/Nord = 85, Mode/Ouest = 71, etc.",
      "temps": "2 min"
    }
  ],

  "zone_travail": {
    "description": "TCD crois√© sur nouvelle feuille",
    "structure": [
      { "cellule": "A1:C13", "label": "Donn√©es source", "style": "data" },
      { "cellule": "Feuil2!A3:F7", "label": "TCD r√©sultat", "style": "pivot" }
    ]
  },

  "checkpoints": [
    {
      "id": "cp_cross_1",
      "type": "pivot_table",
      "description": "TCD cr√©√© avec structure crois√©e",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "pivot_exists": true,
        "has_row_field": true,
        "has_column_field": true
      },
      "points": 25,
      "indices": [
        "Le TCD doit avoir des champs en lignes ET en colonnes.",
        "Tu dois voir une structure matricielle (tableau √† double entr√©e).",
        "Les r√©gions doivent appara√Ætre horizontalement en en-t√™tes de colonnes."
      ]
    },
    {
      "id": "cp_cross_2",
      "type": "pivot_table",
      "description": "Cat√©gorie en lignes",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "row_fields": ["Cat√©gorie"],
        "row_values": ["√âlectronique", "Maison", "Mode"]
      },
      "points": 20,
      "indices": [
        "Les 3 cat√©gories doivent appara√Ætre dans la premi√®re colonne.",
        "L'ordre peut varier (alphab√©tique ou autre)."
      ]
    },
    {
      "id": "cp_cross_3",
      "type": "pivot_table",
      "description": "R√©gion en colonnes",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "column_fields": ["R√©gion"],
        "column_values": ["Est", "Nord", "Ouest", "Sud"]
      },
      "points": 25,
      "indices": [
        "Les 4 r√©gions doivent appara√Ætre en en-t√™tes de colonnes.",
        "Est, Nord, Ouest, Sud (ordre alphab√©tique probable).",
        "Si les r√©gions sont en lignes, d√©place le champ vers 'Colonnes'."
      ],
      "erreurs_probables": [
        { "type": "region_in_rows", "message": "Les r√©gions sont en lignes au lieu d'√™tre en colonnes. D√©place le champ." }
      ]
    },
    {
      "id": "cp_cross_4",
      "type": "pivot_table",
      "description": "Valeurs correctes avec totaux",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "sample_values": {
          "√âlectronique/Nord": 85,
          "Mode/Ouest": 71,
          "Maison/Est": 52
        },
        "row_totals": true,
        "column_totals": true,
        "grand_total": 712
      },
      "points": 30,
      "indices": [
        "V√©rifie quelques valeurs : √âlectronique/Nord = 85, Mode/Ouest = 71.",
        "Les totaux par ligne et par colonne doivent √™tre affich√©s.",
        "Total g√©n√©ral = 712 k‚Ç¨"
      ]
    }
  ],

  "solution_complete": {
    "description": "TCD avec Cat√©gorie en lignes, R√©gion en colonnes, Somme de CA en valeurs. Matrice 3√ó4 + totaux.",
    "etapes_cles": [
      "Cr√©ation TCD nouvelle feuille",
      "Cat√©gorie ‚Üí Lignes",
      "R√©gion ‚Üí Colonnes",
      "CA ‚Üí Valeurs"
    ]
  },

  "feedback_personnalise": {
    "parfait": "üéâ Parfait ! Tu ma√Ætrises le TCD √† double entr√©e. C'est l'outil roi de l'analyse de donn√©es !",
    "bien": "üëç Tr√®s bien ! La structure est bonne. V√©rifie que les r√©gions sont en colonnes, pas en lignes.",
    "ameliorer": "üìä Presque ! Tu as peut-√™tre invers√© lignes et colonnes. R√©gion doit √™tre en colonnes.",
    "revoir": "üîÑ Recommence : Cat√©gorie ‚Üí Lignes, R√©gion ‚Üí Colonnes, CA ‚Üí Valeurs."
  },

  "pour_aller_plus_loin": [
    "Inverse lignes et colonnes pour voir une autre perspective.",
    "Ajoute un 2√®me champ en valeurs (ex: Quantit√©) pour comparer CA et volume.",
    "Utilise le tri pour mettre la meilleure r√©gion en premier."
  ]
}
