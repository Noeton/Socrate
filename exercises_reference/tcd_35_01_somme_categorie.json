{
  "id": "tcd_35_01_somme_categorie",
  "version": "1.0",
  "titre": "üìä TCD : ton premier tableau crois√© dynamique",

  "metadata": {
    "niveau": "intermediaire",
    "duree_estimee": "15 min",
    "competences_ids": [35],
    "competences_noms": ["Tableaux crois√©s dynamiques"],
    "prerequis": [1, 3, 7],
    "objectif_pedagogique": "Cr√©er un TCD simple avec une dimension en ligne et une mesure en valeur",
    "source_pdf": "Chapter 13: Pivot Tables - Section 13.1-13.2",
    "requires_screenshot": true
  },

  "contexte": {
    "situation": "Tu as un fichier de ventes avec des milliers de lignes. Le directeur veut savoir combien rapporte chaque cat√©gorie de produit. Impossible de faire √ßa manuellement !",
    
    "personnage": "Toi, analyste commercial chez MegaStore.",
    
    "objectif": "Cr√©er un tableau crois√© dynamique qui affiche le CA total par cat√©gorie de produit.",
    
    "motivation": "Le TCD est l'outil le plus puissant d'Excel pour analyser des donn√©es. Il r√©sume des millions de lignes en quelques clics.",
    
    "ton": "Le TCD fait peur au d√©but, mais c'est en fait tr√®s simple. Promis !"
  },

  "histoire_des_donnees": {
    "description": "Extrait des ventes du trimestre avec cat√©gorie, produit et montant.",
    "periode": "Q4 2024",
    "source_fictive": "Export CRM MegaStore"
  },

  "donnees": {
    "headers": ["Date", "Cat√©gorie", "Produit", "Quantit√©", "CA (‚Ç¨)"],
    "rows": [
      ["01/10/2024", "√âlectronique", "Smartphone", 5, 2500],
      ["02/10/2024", "Mode", "Jean", 12, 720],
      ["03/10/2024", "√âlectronique", "Tablette", 3, 900],
      ["04/10/2024", "Maison", "Lampe", 8, 320],
      ["05/10/2024", "Mode", "T-shirt", 25, 500],
      ["06/10/2024", "√âlectronique", "√âcouteurs", 15, 750],
      ["07/10/2024", "Maison", "Coussin", 20, 400],
      ["08/10/2024", "Mode", "Pull", 10, 600],
      ["09/10/2024", "√âlectronique", "Smartphone", 8, 4000],
      ["10/10/2024", "Maison", "Vase", 6, 180],
      ["11/10/2024", "Mode", "Chaussures", 7, 560],
      ["12/10/2024", "√âlectronique", "Tablette", 4, 1200]
    ],
    "placement": {
      "start_cell": "A1",
      "headers_row": 1
    }
  },

  "etapes": [
    {
      "numero": 1,
      "titre": "S√©lectionner les donn√©es",
      "consigne": "Clique sur une cellule dans tes donn√©es (ex: A1). Excel d√©tectera automatiquement la plage.",
      "aide_contextuelle": "Pas besoin de tout s√©lectionner. Excel est intelligent !",
      "temps": "1 min"
    },
    {
      "numero": 2,
      "titre": "Ins√©rer le TCD",
      "consigne": "Insertion > Tableau crois√© dynamique. Dans la bo√Æte de dialogue, choisis 'Nouvelle feuille de calcul' puis OK.",
      "aide_contextuelle": "Le TCD sera cr√©√© sur une nouvelle feuille pour ne pas m√©langer avec tes donn√©es.",
      "temps": "2 min"
    },
    {
      "numero": 3,
      "titre": "Ajouter le champ Cat√©gorie en lignes",
      "description": "Le volet 'Champs de tableau crois√©' appara√Æt √† droite.",
      "consigne": "Glisse le champ 'Cat√©gorie' dans la zone 'Lignes' (ou coche-le).",
      "aide_contextuelle": "Les lignes d√©finissent les cat√©gories d'analyse. Ici, on veut voir par cat√©gorie de produit.",
      "temps": "2 min"
    },
    {
      "numero": 4,
      "titre": "Ajouter le CA en valeurs",
      "consigne": "Glisse le champ 'CA (‚Ç¨)' dans la zone 'Valeurs'. Il devient 'Somme de CA (‚Ç¨)'.",
      "aide_contextuelle": "Par d√©faut, Excel fait une SOMME pour les nombres. C'est exactement ce qu'on veut !",
      "temps": "2 min"
    },
    {
      "numero": 5,
      "titre": "V√©rifier le r√©sultat",
      "description": "Le TCD affiche maintenant le CA total par cat√©gorie.",
      "consigne": "Tu dois voir 3 lignes : √âlectronique, Maison, Mode avec leurs totaux respectifs.",
      "aide_contextuelle": "√âlectronique = 9350‚Ç¨, Maison = 900‚Ç¨, Mode = 2380‚Ç¨, Total = 12630‚Ç¨",
      "temps": "2 min"
    }
  ],

  "zone_travail": {
    "description": "TCD sur nouvelle feuille",
    "structure": [
      { "cellule": "A1:E13", "label": "Donn√©es source", "style": "data" },
      { "cellule": "Feuil2!A3:B7", "label": "TCD r√©sultat", "style": "pivot" }
    ]
  },

  "checkpoints": [
    {
      "id": "cp_tcd_1",
      "type": "pivot_table",
      "description": "TCD cr√©√©",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "pivot_exists": true,
        "on_new_sheet": true
      },
      "points": 25,
      "indices": [
        "Le TCD doit √™tre sur une nouvelle feuille de calcul.",
        "Tu dois voir le volet 'Champs de tableau crois√©' √† droite.",
        "Si le volet n'appara√Æt pas, clique sur le TCD pour l'activer."
      ],
      "erreurs_probables": [
        { "type": "no_pivot", "message": "Pas de TCD cr√©√©. Va dans Insertion > Tableau crois√© dynamique." },
        { "type": "same_sheet", "message": "Le TCD est sur la m√™me feuille que les donn√©es. Choisis 'Nouvelle feuille'." }
      ]
    },
    {
      "id": "cp_tcd_2",
      "type": "pivot_table",
      "description": "Champ Cat√©gorie en lignes",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "row_fields": ["Cat√©gorie"],
        "row_count": 3
      },
      "points": 25,
      "indices": [
        "Le champ 'Cat√©gorie' doit √™tre dans la zone 'Lignes'.",
        "Tu dois voir √âlectronique, Maison, Mode dans la colonne A.",
        "Glisse 'Cat√©gorie' depuis la liste des champs vers 'Lignes'."
      ]
    },
    {
      "id": "cp_tcd_3",
      "type": "pivot_table",
      "description": "Somme de CA en valeurs",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "value_fields": ["Somme de CA"],
        "function": "sum"
      },
      "points": 25,
      "indices": [
        "Le champ 'CA (‚Ç¨)' doit √™tre dans la zone 'Valeurs'.",
        "L'en-t√™te de colonne doit afficher 'Somme de CA (‚Ç¨)' ou similaire.",
        "Si tu vois 'Nombre de CA', change la fonction en Somme (clic droit > Param√®tres)."
      ],
      "erreurs_probables": [
        { "type": "count_instead_sum", "message": "Tu affiches le NOMBRE au lieu de la SOMME. Clic droit sur le champ > Param√®tres > Somme." }
      ]
    },
    {
      "id": "cp_tcd_4",
      "type": "pivot_table",
      "description": "Valeurs correctes",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "values": {
          "√âlectronique": 9350,
          "Maison": 900,
          "Mode": 2380
        },
        "total": 12630
      },
      "points": 25,
      "indices": [
        "√âlectronique = 2500+900+750+4000+1200 = 9350‚Ç¨",
        "Maison = 320+400+180 = 900‚Ç¨",
        "Mode = 720+500+600+560 = 2380‚Ç¨",
        "Total g√©n√©ral = 12630‚Ç¨"
      ]
    }
  ],

  "solution_complete": {
    "description": "TCD sur nouvelle feuille avec Cat√©gorie en lignes, Somme de CA en valeurs. 3 cat√©gories + total.",
    "etapes_cles": [
      "Clic dans donn√©es > Insertion > TCD",
      "Nouvelle feuille",
      "Cat√©gorie ‚Üí Lignes",
      "CA ‚Üí Valeurs (Somme)"
    ]
  },

  "feedback_personnalise": {
    "parfait": "üéâ F√©licitations ! Tu viens de cr√©er ton premier TCD. C'est une comp√©tence qui change la vie !",
    "bien": "üëç Tr√®s bien ! Le TCD fonctionne. V√©rifie que les totaux sont corrects.",
    "ameliorer": "üìä Presque ! Assure-toi que Cat√©gorie est en lignes et CA en valeurs.",
    "revoir": "üîÑ Recommence : Insertion > TCD > glisse Cat√©gorie vers Lignes et CA vers Valeurs."
  },

  "pour_aller_plus_loin": [
    "Ajoute le champ 'Produit' en lignes sous Cat√©gorie pour plus de d√©tails.",
    "Change la fonction de Somme √† Moyenne pour voir le panier moyen.",
    "Ajoute un filtre sur la Date pour analyser p√©riode par p√©riode."
  ]
}
