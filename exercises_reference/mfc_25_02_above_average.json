{
  "id": "mfc_25_02_above_average",
  "version": "1.0",
  "titre": "üìä MFC avanc√©e : au-dessus de la moyenne",

  "metadata": {
    "niveau": "intermediaire",
    "duree_estimee": "10 min",
    "competences_ids": [25],
    "competences_noms": ["MFC avanc√©e"],
    "prerequis": [10],
    "objectif_pedagogique": "Utiliser la r√®gle 'Sup√©rieur √† la moyenne' pour identifier les valeurs au-dessus de la norme",
    "source_pdf": "Chapter 27: Conditional formatting - Section 27.5 (FormatConditions.AddAboveAverage)",
    "requires_screenshot": true
  },

  "contexte": {
    "situation": "Tu analyses les performances de ton √©quipe de support client. Tu veux identifier les agents qui traitent plus de tickets que la moyenne pour les f√©liciter.",
    
    "personnage": "Toi, superviseur du service client.",
    
    "objectif": "Colorer automatiquement les performances sup√©rieures √† la moyenne de l'√©quipe.",
    
    "motivation": "La moyenne est calcul√©e automatiquement par Excel. Pas besoin de formule MOYENNE() s√©par√©e !",
    
    "ton": "Excel fait le calcul pour toi. Malin, non ?"
  },

  "histoire_des_donnees": {
    "description": "Nombre de tickets trait√©s par agent ce mois-ci.",
    "periode": "Janvier 2025",
    "source_fictive": "CRM Support"
  },

  "donnees": {
    "headers": ["Agent", "Tickets trait√©s"],
    "rows": [
      ["Marie D.", 145],
      ["Paul L.", 112],
      ["Sophie M.", 168],
      ["Lucas B.", 98],
      ["Emma R.", 134],
      ["Thomas K.", 156],
      ["Julie F.", 121],
      ["Antoine P.", 142],
      ["L√©a S.", 108],
      ["Marc V.", 176]
    ],
    "placement": {
      "start_cell": "A1",
      "headers_row": 1
    }
  },

  "etapes": [
    {
      "numero": 1,
      "titre": "S√©lectionner les donn√©es",
      "consigne": "S√©lectionne B2:B11 (nombre de tickets).",
      "temps": "1 min"
    },
    {
      "numero": 2,
      "titre": "Appliquer la r√®gle",
      "consigne": "Accueil > MFC > R√®gles des valeurs plus/moins √©lev√©es > Sup√©rieur √† la moyenne...",
      "aide_contextuelle": "Excel calcule automatiquement la moyenne de ta s√©lection.",
      "temps": "2 min"
    },
    {
      "numero": 3,
      "titre": "Choisir le format",
      "consigne": "Choisis un format vert clair pour indiquer la bonne performance.",
      "temps": "1 min"
    },
    {
      "numero": 4,
      "titre": "V√©rifier le r√©sultat",
      "description": "La moyenne est 136. Les agents > 136 doivent √™tre verts.",
      "consigne": "V√©rifie que Marie (145), Sophie (168), Thomas (156), Antoine (142) et Marc (176) sont color√©s.",
      "aide_contextuelle": "5 agents sur 10 sont au-dessus de la moyenne.",
      "temps": "1 min"
    }
  ],

  "zone_travail": {
    "description": "MFC sur la colonne Tickets",
    "structure": [
      { "cellule": "A1:B11", "label": "Donn√©es", "style": "data" },
      { "cellule": "B2:B11", "label": "Zone MFC", "style": "mfc_zone" }
    ]
  },

  "checkpoints": [
    {
      "id": "cp_avg_1",
      "type": "format",
      "subtype": "mfc_above_average",
      "description": "R√®gle 'Sup√©rieur √† la moyenne' appliqu√©e",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "mfc_detected": true,
        "rule_type": "above_average"
      },
      "points": 40,
      "indices": [
        "Utilise 'R√®gles des valeurs plus/moins √©lev√©es > Sup√©rieur √† la moyenne'.",
        "Ne confonds pas avec 'Sup√©rieur √†...' qui demande une valeur fixe.",
        "Excel calcule la moyenne automatiquement."
      ],
      "erreurs_probables": [
        { "type": "fixed_value_rule", "message": "Tu as utilis√© 'Sup√©rieur √†' avec une valeur fixe. Utilise 'Sup√©rieur √† la moyenne'." },
        { "type": "below_average", "message": "Tu as s√©lectionn√© 'Inf√©rieur √† la moyenne' au lieu de 'Sup√©rieur'." }
      ]
    },
    {
      "id": "cp_avg_2",
      "type": "format",
      "subtype": "mfc_color",
      "description": "Format vert appliqu√©",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "fill_color": "green",
        "fill_color_variants": ["vert", "green", "lightgreen", "vert clair"]
      },
      "points": 20,
      "indices": [
        "Le vert indique une bonne performance.",
        "Choisis 'Remplissage vert clair' ou personnalise."
      ]
    },
    {
      "id": "cp_avg_3",
      "type": "format",
      "subtype": "mfc_coverage",
      "description": "5 cellules color√©es (> moyenne 136)",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "colored_cells_count": 5,
        "average_value": 136,
        "colored_agents": ["Marie D.", "Sophie M.", "Thomas K.", "Antoine P.", "Marc V."]
      },
      "points": 30,
      "indices": [
        "La moyenne est (145+112+168+98+134+156+121+142+108+176)/10 = 136.",
        "5 agents ont plus de 136 tickets : Marie, Sophie, Thomas, Antoine, Marc.",
        "Les 5 autres (Paul, Lucas, Emma, Julie, L√©a) ne doivent PAS √™tre color√©s."
      ]
    },
    {
      "id": "cp_avg_4",
      "type": "format",
      "subtype": "mfc_range",
      "description": "MFC sur la bonne plage",
      "competence_id": 25,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "range": "B2:B11"
      },
      "points": 10
    }
  ],

  "solution_complete": {
    "description": "R√®gle 'Sup√©rieur √† la moyenne' avec format vert sur B2:B11. 5 agents sur 10 sont mis en √©vidence.",
    "etapes_cles": [
      "S√©lection B2:B11",
      "MFC > Sup√©rieur √† la moyenne",
      "Format vert"
    ]
  },

  "feedback_personnalise": {
    "parfait": "üéâ Parfait ! Tu as identifi√© les 5 agents les plus performants sans aucun calcul manuel !",
    "bien": "üëç Tr√®s bien ! La r√®gle est appliqu√©e. V√©rifie que seuls les agents > 136 sont verts.",
    "ameliorer": "üìä Presque ! Utilise bien 'Sup√©rieur √† la moyenne', pas une valeur fixe.",
    "revoir": "üîÑ Recommence : MFC > Valeurs plus √©lev√©es > Sup√©rieur √† la moyenne."
  },

  "pour_aller_plus_loin": [
    "Ajoute 'Inf√©rieur √† la moyenne' en rouge pour voir les deux groupes.",
    "Essaie '1 √©cart-type au-dessus de la moyenne' pour les vraies stars.",
    "Combine avec des ic√¥nes pour un effet visuel renforc√©."
  ]
}
