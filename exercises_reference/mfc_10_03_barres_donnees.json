{
  "id": "mfc_10_03_barres_donnees",
  "version": "1.0",
  "titre": "üìä MFC : barres de donn√©es pour comparer visuellement",

  "metadata": {
    "niveau": "debutant",
    "duree_estimee": "10 min",
    "competences_ids": [10],
    "competences_noms": ["Mise en forme conditionnelle simple"],
    "prerequis": [1, 2],
    "objectif_pedagogique": "Appliquer des barres de donn√©es pour repr√©senter visuellement les valeurs directement dans les cellules",
    "source_pdf": "Chapter 27: Conditional formatting - Section 27.1 (xlDatabar)",
    "requires_screenshot": true
  },

  "contexte": {
    "situation": "Tu pr√©pares l'√©valuation annuelle de ton √©quipe. Tu veux un tableau qui montre visuellement les performances de chacun, comme un mini-graphique dans chaque cellule.",
    
    "personnage": "Toi, RH chez TechCorp pr√©parant les entretiens annuels.",
    
    "objectif": "Ajouter des barres horizontales dans les cellules qui repr√©sentent proportionnellement chaque score.",
    
    "motivation": "Les barres de donn√©es cr√©ent un mini-histogramme dans chaque cellule. Ultra efficace pour comparer des valeurs sans cr√©er de graphique s√©par√©.",
    
    "ton": "C'est comme avoir un graphique int√©gr√© directement dans ton tableau !"
  },

  "histoire_des_donnees": {
    "description": "Scores d'√©valuation annuelle de l'√©quipe Tech (note sur 100).",
    "periode": "√âvaluation 2024",
    "source_fictive": "SIRH TechCorp"
  },

  "donnees": {
    "headers": ["Employ√©", "D√©partement", "Score"],
    "rows": [
      ["Martin D.", "Dev", 82],
      ["Sophie L.", "Dev", 91],
      ["Thomas B.", "QA", 75],
      ["Julie M.", "Design", 88],
      ["Pierre R.", "Dev", 69],
      ["Emma C.", "PM", 94],
      ["Lucas F.", "QA", 78],
      ["L√©a S.", "Design", 85]
    ],
    "placement": {
      "start_cell": "A1",
      "headers_row": 1
    }
  },

  "etapes": [
    {
      "numero": 1,
      "titre": "S√©lectionner les scores",
      "consigne": "S√©lectionne C2:C9 (les scores d'√©valuation).",
      "temps": "1 min"
    },
    {
      "numero": 2,
      "titre": "Appliquer les barres de donn√©es",
      "consigne": "Accueil > Mise en forme conditionnelle > Barres de donn√©es > Remplissage d√©grad√© bleu (ou une autre couleur).",
      "aide_contextuelle": "Tu peux choisir un remplissage uni ou d√©grad√©. Le d√©grad√© est plus joli.",
      "temps": "2 min"
    },
    {
      "numero": 3,
      "titre": "V√©rifier le r√©sultat",
      "description": "Chaque cellule doit avoir une barre horizontale proportionnelle √† sa valeur.",
      "consigne": "Emma (94) doit avoir la barre la plus longue, Pierre (69) la plus courte.",
      "aide_contextuelle": "Les barres sont calcul√©es automatiquement : la valeur max = barre compl√®te.",
      "temps": "1 min"
    },
    {
      "numero": 4,
      "titre": "Ajuster (optionnel)",
      "description": "Par d√©faut, Excel ajuste entre le min et le max des donn√©es. Tu peux fixer les bornes.",
      "consigne": "Clic droit sur une cellule > G√©rer les r√®gles > Modifier la r√®gle > D√©finir Min=0 et Max=100.",
      "aide_contextuelle": "Avec Min=0 et Max=100, un score de 50 aura une barre √† mi-largeur.",
      "temps": "3 min",
      "optionnel": true
    }
  ],

  "zone_travail": {
    "description": "Barres de donn√©es sur la colonne Score",
    "structure": [
      { "cellule": "A1:C9", "label": "Donn√©es", "style": "data" },
      { "cellule": "C2:C9", "label": "Zone MFC", "style": "mfc_zone" }
    ]
  },

  "checkpoints": [
    {
      "id": "cp_databar_1",
      "type": "format",
      "subtype": "mfc_databar",
      "description": "Barres de donn√©es appliqu√©es",
      "competence_id": 10,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "mfc_detected": true,
        "rule_type": "databar",
        "has_bars": true
      },
      "points": 40,
      "indices": [
        "Tu dois voir des barres horizontales dans chaque cellule de la colonne Score.",
        "Accueil > MFC > Barres de donn√©es",
        "Les barres doivent varier en longueur selon la valeur."
      ],
      "erreurs_probables": [
        { "type": "no_bars", "message": "Pas de barres visibles. As-tu bien appliqu√© 'Barres de donn√©es' et pas une autre r√®gle ?" },
        { "type": "same_length", "message": "Toutes les barres ont la m√™me longueur. C'est anormal, v√©rifie la r√®gle." }
      ]
    },
    {
      "id": "cp_databar_2",
      "type": "format",
      "subtype": "mfc_databar_color",
      "description": "Couleur coh√©rente (bleu recommand√©)",
      "competence_id": 10,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "bar_color": "blue",
        "bar_color_variants": ["bleu", "blue", "lightblue", "cyan"]
      },
      "points": 20,
      "indices": [
        "Le bleu est la couleur standard pour les barres de donn√©es.",
        "Tu peux choisir une autre couleur, mais √©vite le rouge (connotation n√©gative).",
        "Les barres peuvent √™tre en d√©grad√© ou en uni."
      ]
    },
    {
      "id": "cp_databar_3",
      "type": "format",
      "subtype": "mfc_databar_proportion",
      "description": "Barres proportionnelles aux valeurs",
      "competence_id": 10,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "max_bar_employee": "Emma C.",
        "min_bar_employee": "Pierre R.",
        "bars_proportional": true
      },
      "points": 25,
      "indices": [
        "Emma (94) doit avoir la barre la plus longue.",
        "Pierre (69) doit avoir la barre la plus courte.",
        "Les autres doivent √™tre proportionnelles entre ces deux extr√™mes."
      ]
    },
    {
      "id": "cp_databar_4",
      "type": "format",
      "subtype": "mfc_range",
      "description": "MFC sur la bonne plage",
      "competence_id": 10,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "range": "C2:C9",
        "excludes_header": true
      },
      "points": 15,
      "indices": [
        "Les barres doivent √™tre uniquement sur C2:C9.",
        "L'en-t√™te 'Score' ne doit pas avoir de barre."
      ]
    }
  ],

  "solution_complete": {
    "description": "Barres de donn√©es bleues (d√©grad√©) sur C2:C9. Emma (94) a la barre la plus longue, Pierre (69) la plus courte.",
    "etapes_cles": [
      "S√©lection C2:C9",
      "Accueil > MFC > Barres de donn√©es",
      "Choisir d√©grad√© bleu"
    ]
  },

  "feedback_personnalise": {
    "parfait": "üéâ Parfait ! Ton tableau est devenu un dashboard visuel. On voit imm√©diatement qu'Emma et Sophie sont les top performers !",
    "bien": "üëç Tr√®s bien ! Les barres sont l√†. V√©rifie qu'elles sont bien proportionnelles (Emma > Sophie > Julie...).",
    "ameliorer": "üìä Presque ! Les barres doivent √™tre de longueurs diff√©rentes selon les scores.",
    "revoir": "üîÑ Recommence : s√©lectionne C2:C9, puis MFC > Barres de donn√©es > Bleu. Tu dois voir des barres horizontales."
  },

  "pour_aller_plus_loin": [
    "Fixe les bornes Min=0 et Max=100 pour une √©chelle absolue.",
    "Ajoute une bordure aux barres via 'Modifier la r√®gle'.",
    "Masque les valeurs pour ne voir que les barres (Format personnalis√© : ;;;)."
  ]
}
