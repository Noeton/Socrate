{
  "id": "tcd_35_03_filtre",
  "version": "1.0",
  "titre": "üîç TCD : ajouter un filtre interactif",

  "metadata": {
    "niveau": "intermediaire",
    "duree_estimee": "12 min",
    "competences_ids": [35],
    "competences_noms": ["Tableaux crois√©s dynamiques"],
    "prerequis": [35],
    "objectif_pedagogique": "Ajouter un champ de filtre (zone Page) pour analyser les donn√©es par segment",
    "source_pdf": "Chapter 13: Pivot Tables - Section 13.1 (xlPageField)",
    "requires_screenshot": true
  },

  "contexte": {
    "situation": "Tu analyses les ventes sur plusieurs ann√©es. Le directeur veut pouvoir filtrer par ann√©e pour comparer les performances ann√©e par ann√©e.",
    
    "personnage": "Toi, analyste financier pr√©parant un rapport flexible.",
    
    "objectif": "Cr√©er un TCD avec un filtre par ann√©e permettant d'isoler chaque exercice.",
    
    "motivation": "Le filtre (zone Page) permet de cr√©er des rapports interactifs sans recr√©er le TCD.",
    
    "ton": "Le filtre TCD, c'est comme un bouton magique pour changer de perspective !"
  },

  "histoire_des_donnees": {
    "description": "Ventes par produit sur 3 ann√©es.",
    "periode": "2022-2024",
    "source_fictive": "Historique commercial"
  },

  "donnees": {
    "headers": ["Ann√©e", "Produit", "CA (k‚Ç¨)"],
    "rows": [
      ["2022", "Laptop", 120],
      ["2022", "Tablette", 85],
      ["2022", "Smartphone", 95],
      ["2023", "Laptop", 145],
      ["2023", "Tablette", 92],
      ["2023", "Smartphone", 110],
      ["2024", "Laptop", 168],
      ["2024", "Tablette", 98],
      ["2024", "Smartphone", 125]
    ],
    "placement": {
      "start_cell": "A1",
      "headers_row": 1
    }
  },

  "etapes": [
    {
      "numero": 1,
      "titre": "Cr√©er le TCD de base",
      "consigne": "Insertion > TCD > Nouvelle feuille. Mets 'Produit' en lignes et 'CA' en valeurs.",
      "temps": "3 min"
    },
    {
      "numero": 2,
      "titre": "Ajouter le filtre Ann√©e",
      "consigne": "Glisse le champ 'Ann√©e' dans la zone 'Filtres' (en haut du volet).",
      "aide_contextuelle": "La zone Filtres est au-dessus des zones Colonnes et Lignes.",
      "temps": "2 min"
    },
    {
      "numero": 3,
      "titre": "Observer le filtre",
      "description": "Un menu d√©roulant appara√Æt au-dessus du TCD.",
      "consigne": "Tu dois voir 'Ann√©e' avec '(Tous)' au-dessus de ton tableau.",
      "temps": "1 min"
    },
    {
      "numero": 4,
      "titre": "Tester le filtre",
      "consigne": "Clique sur le menu d√©roulant 'Ann√©e' et s√©lectionne '2024' uniquement.",
      "aide_contextuelle": "Le TCD se met √† jour instantan√©ment pour n'afficher que 2024.",
      "temps": "2 min"
    },
    {
      "numero": 5,
      "titre": "V√©rifier les totaux filtr√©s",
      "consigne": "Avec filtre 2024 : Laptop=168, Tablette=98, Smartphone=125, Total=391.",
      "temps": "2 min"
    }
  ],

  "checkpoints": [
    {
      "id": "cp_filter_1",
      "type": "pivot_table",
      "description": "Champ Ann√©e dans zone Filtres",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "page_fields": ["Ann√©e"],
        "filter_visible": true
      },
      "points": 35,
      "indices": [
        "Le champ 'Ann√©e' doit √™tre dans la zone 'Filtres' du volet.",
        "Tu dois voir 'Ann√©e' avec un menu d√©roulant AU-DESSUS du TCD.",
        "Si 'Ann√©e' est en lignes ou colonnes, d√©place-le vers 'Filtres'."
      ],
      "erreurs_probables": [
        { "type": "year_in_rows", "message": "L'ann√©e est en lignes, pas en filtre. D√©place vers la zone 'Filtres'." },
        { "type": "no_filter", "message": "Pas de zone filtre visible. Glisse 'Ann√©e' vers 'Filtres' dans le volet." }
      ]
    },
    {
      "id": "cp_filter_2",
      "type": "pivot_table",
      "description": "Produit en lignes",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "row_fields": ["Produit"]
      },
      "points": 20
    },
    {
      "id": "cp_filter_3",
      "type": "pivot_table",
      "description": "Filtre fonctionnel",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "filter_works": true,
        "filter_value_2024": {
          "Laptop": 168,
          "Tablette": 98,
          "Smartphone": 125,
          "Total": 391
        }
      },
      "points": 30,
      "indices": [
        "Quand tu filtres sur 2024, les valeurs doivent changer.",
        "Total 2024 = 391 k‚Ç¨",
        "Total toutes ann√©es = 1038 k‚Ç¨"
      ]
    },
    {
      "id": "cp_filter_4",
      "type": "pivot_table",
      "description": "Somme de CA en valeurs",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "value_fields": ["Somme de CA"]
      },
      "points": 15
    }
  ],

  "solution_complete": {
    "description": "TCD avec Ann√©e en Filtres, Produit en Lignes, Somme de CA en Valeurs.",
    "etapes_cles": [
      "Cr√©er TCD",
      "Ann√©e ‚Üí Filtres",
      "Produit ‚Üí Lignes",
      "CA ‚Üí Valeurs"
    ]
  },

  "feedback_personnalise": {
    "parfait": "üéâ Parfait ! Ton rapport est interactif. Le directeur peut explorer ann√©e par ann√©e !",
    "bien": "üëç Bien ! Le filtre est l√†. Teste-le pour v√©rifier qu'il fonctionne.",
    "ameliorer": "üîç Presque ! Assure-toi que 'Ann√©e' est dans la zone 'Filtres', pas en lignes.",
    "revoir": "üîÑ Glisse 'Ann√©e' vers la zone 'Filtres' en haut du volet des champs."
  }
}
