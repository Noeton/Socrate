{
  "id": "tcd_35_04_multi_valeurs",
  "version": "1.0",
  "titre": "ğŸ“Š TCD : plusieurs mesures en valeurs",

  "metadata": {
    "niveau": "avance",
    "duree_estimee": "15 min",
    "competences_ids": [35],
    "competences_noms": ["Tableaux croisÃ©s dynamiques"],
    "prerequis": [35],
    "objectif_pedagogique": "Ajouter plusieurs champs en valeurs avec diffÃ©rentes fonctions d'agrÃ©gation",
    "source_pdf": "Chapter 13: Pivot Tables - Section 13.1",
    "requires_screenshot": true
  },

  "contexte": {
    "situation": "Tu analyses les performances commerciales. Tu veux voir Ã  la fois le CA total ET le nombre de ventes par vendeur.",
    
    "personnage": "Toi, manager commercial analysant ton Ã©quipe.",
    
    "objectif": "CrÃ©er un TCD qui affiche Somme du CA et Nombre de ventes cÃ´te Ã  cÃ´te.",
    
    "motivation": "Un seul TCD, plusieurs KPIs ! Plus besoin de crÃ©er plusieurs tableaux.",
    
    "ton": "On combine les mÃ©triques pour une vue 360Â° des performances."
  },

  "histoire_des_donnees": {
    "description": "DÃ©tail des ventes par vendeur avec montant et nombre de transactions.",
    "periode": "Q4 2024",
    "source_fictive": "CRM Commercial"
  },

  "donnees": {
    "headers": ["Vendeur", "Produit", "QuantitÃ©", "CA (â‚¬)"],
    "rows": [
      ["Marie", "Laptop", 2, 2400],
      ["Marie", "Tablette", 5, 2500],
      ["Marie", "Accessoires", 12, 360],
      ["Pierre", "Laptop", 3, 3600],
      ["Pierre", "Smartphone", 4, 2800],
      ["Sophie", "Tablette", 6, 3000],
      ["Sophie", "Laptop", 1, 1200],
      ["Sophie", "Accessoires", 8, 240],
      ["Lucas", "Smartphone", 7, 4900],
      ["Lucas", "Accessoires", 15, 450]
    ],
    "placement": {
      "start_cell": "A1",
      "headers_row": 1
    }
  },

  "etapes": [
    {
      "numero": 1,
      "titre": "CrÃ©er le TCD",
      "consigne": "Insertion > TCD > Nouvelle feuille. Mets 'Vendeur' en lignes.",
      "temps": "2 min"
    },
    {
      "numero": 2,
      "titre": "Ajouter Somme du CA",
      "consigne": "Glisse 'CA (â‚¬)' dans la zone 'Valeurs'. Il devient 'Somme de CA'.",
      "temps": "1 min"
    },
    {
      "numero": 3,
      "titre": "Ajouter Somme des QuantitÃ©s",
      "consigne": "Glisse aussi 'QuantitÃ©' dans la zone 'Valeurs'.",
      "aide_contextuelle": "Tu peux mettre plusieurs champs dans Valeurs !",
      "temps": "2 min"
    },
    {
      "numero": 4,
      "titre": "Ajouter Nombre de ventes",
      "description": "On veut aussi compter le nombre de lignes (transactions) par vendeur.",
      "consigne": "Glisse 'Produit' dans Valeurs. Clic droit > ParamÃ¨tres > Change 'Somme' en 'Nombre'.",
      "aide_contextuelle": "Le 'Nombre' compte les cellules non vides, donc le nombre de transactions.",
      "temps": "3 min"
    },
    {
      "numero": 5,
      "titre": "VÃ©rifier le rÃ©sultat",
      "consigne": "Tu dois voir 3 colonnes par vendeur : Somme CA, Somme QuantitÃ©, Nombre de Produit.",
      "aide_contextuelle": "Marie : CA=5260, QtÃ©=19, Nb=3 transactions.",
      "temps": "2 min"
    }
  ],

  "checkpoints": [
    {
      "id": "cp_multi_val_1",
      "type": "pivot_table",
      "description": "Plusieurs champs en Valeurs",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "value_fields_count": 3,
        "value_fields": ["Somme de CA", "Somme de QuantitÃ©", "Nombre de Produit"]
      },
      "points": 35,
      "indices": [
        "Tu dois avoir 3 champs dans la zone 'Valeurs'.",
        "Glisse plusieurs champs vers Valeurs.",
        "Les colonnes du TCD affichent chaque mesure."
      ],
      "erreurs_probables": [
        { "type": "single_value", "message": "Tu n'as qu'un seul champ en Valeurs. Ajoutes-en d'autres." }
      ]
    },
    {
      "id": "cp_multi_val_2",
      "type": "pivot_table",
      "description": "Fonction Nombre utilisÃ©e",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "has_count_function": true,
        "count_field": "Nombre de Produit"
      },
      "points": 25,
      "indices": [
        "Un des champs doit utiliser 'Nombre' (pas Somme).",
        "Clic droit sur le champ > ParamÃ¨tres > RÃ©sumer par > Nombre.",
        "Le 'Nombre' compte les lignes, la 'Somme' additionne les valeurs."
      ],
      "erreurs_probables": [
        { "type": "all_sum", "message": "Tous tes champs sont en 'Somme'. Change-en un en 'Nombre'." }
      ]
    },
    {
      "id": "cp_multi_val_3",
      "type": "pivot_table",
      "description": "Valeurs correctes pour Marie",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "marie_values": {
          "somme_ca": 5260,
          "somme_qte": 19,
          "nombre": 3
        }
      },
      "points": 25,
      "indices": [
        "Marie : CA = 2400+2500+360 = 5260â‚¬",
        "Marie : QuantitÃ© = 2+5+12 = 19",
        "Marie : 3 transactions (3 lignes)"
      ]
    },
    {
      "id": "cp_multi_val_4",
      "type": "pivot_table",
      "description": "Vendeur en lignes",
      "competence_id": 35,
      "validation_type": "visual",
      "requires_screenshot": true,
      "expected": {
        "row_fields": ["Vendeur"]
      },
      "points": 15
    }
  ],

  "solution_complete": {
    "description": "TCD avec Vendeur en lignes, 3 champs en valeurs : Somme CA, Somme QuantitÃ©, Nombre de transactions.",
    "etapes_cles": [
      "Vendeur â†’ Lignes",
      "CA â†’ Valeurs (Somme)",
      "QuantitÃ© â†’ Valeurs (Somme)",
      "Produit â†’ Valeurs (Nombre)"
    ]
  },

  "feedback_personnalise": {
    "parfait": "ğŸ‰ Excellent ! Tu maÃ®trises les TCD multi-valeurs. Une vue complÃ¨te en un seul tableau !",
    "bien": "ğŸ‘ Bien ! VÃ©rifie que tu as bien 3 mesures diffÃ©rentes.",
    "ameliorer": "ğŸ“Š Presque ! N'oublie pas de changer une fonction en 'Nombre'.",
    "revoir": "ğŸ”„ Glisse plusieurs champs vers Valeurs et utilise 'Nombre' pour compter."
  }
}
