{
    "id": "avance_06_power_query_intro",
    "titre": "Power Query : Automatiser le Nettoyage de Donn√©es",
    "niveau": "avance",
    "duree_estimee": "30 min",
    "competences": ["Power Query", "ETL", "Nettoyage donn√©es", "Transformation"],
    "competence_ids": [30],
  
    "contexte": {
      "situation": "Tu es data analyst chez DataClean Corp. Chaque mois, tu re√ßois des fichiers de donn√©es mal format√©s : colonnes inutiles, types incorrects, valeurs manquantes, formats incoh√©rents... Avant, tu passais des heures √† nettoyer manuellement. Power Query automatise tout √ßa et garde un historique des transformations !",
      "manager": {
        "nom": "Thomas Leclerc",
        "poste": "Directeur Data",
        "personnalite": "Passionn√© d'automatisation, il d√©teste les t√¢ches r√©p√©titives.",
        "demande": "Chaque mois c'est la m√™me gal√®re : nettoyer les donn√©es avant de les analyser. Je veux que tu cr√©es un processus reproductible. Power Query garde toutes les √©tapes en m√©moire - le mois prochain, un clic et c'est fait !"
      },
      "enjeux": "Automatisation du reporting mensuel.",
      "deadline": "Processus √† mettre en place cette semaine"
    },
  
    "objectifs": [
      "Importer des donn√©es dans Power Query",
      "Nettoyer les donn√©es (supprimer colonnes, filtrer, remplacer)",
      "Transformer les types de donn√©es",
      "Fusionner des requ√™tes (VLOOKUP am√©lior√©)",
      "Charger le r√©sultat dans Excel"
    ],
  
    "prerequis_excel": {
      "version_minimum": "Excel 2016",
      "acces": "Donn√©es > Obtenir et transformer",
      "note": "Power Query est int√©gr√© depuis Excel 2016. Avant, c'√©tait un add-in."
    },
  
    "donnees": {
      "fichier_ventes": {
        "nom": "ventes_brutes.csv",
        "problemes": [
          "Colonnes inutiles (ID_interne, Code_legacy)",
          "Dates au format texte am√©ricain (MM/DD/YYYY)",
          "Montants avec symbole $ √† enlever",
          "Valeurs nulles repr√©sent√©es par 'N/A' ou '-'"
        ],
        "apercu": [
          ["ID_interne", "Code_legacy", "Date", "Produit", "Montant", "R√©gion"],
          ["X001", "OLD_1", "01/15/2025", "Widget A", "$1,250.00", "North"],
          ["X002", "OLD_2", "01/20/2025", "Widget B", "N/A", "South"],
          ["X003", "OLD_3", "02/01/2025", "Widget A", "$890.50", "North"]
        ]
      },
      "fichier_regions": {
        "nom": "regions.xlsx",
        "contenu": [
          ["Code", "Nom_FR"],
          ["North", "Nord"],
          ["South", "Sud"],
          ["East", "Est"],
          ["West", "Ouest"]
        ]
      }
    },
  
    "etapes": [
      {
        "phase": "A. Acc√©der √† Power Query",
        "acces": "Donn√©es > Obtenir des donn√©es > √Ä partir d'un fichier",
        "sources_possibles": [
          "Fichier Excel (.xlsx)",
          "Fichier CSV/Texte",
          "Dossier (plusieurs fichiers)",
          "Base de donn√©es, Web, API..."
        ]
      },
      {
        "phase": "B. L'√©diteur Power Query",
        "interface": [
          "Aper√ßu des donn√©es au centre",
          "√âtapes appliqu√©es √† droite",
          "Ruban avec les transformations",
          "Barre de formules M (optionnel)"
        ],
        "principe": "Chaque action cr√©e une √©tape. Tu peux modifier/supprimer des √©tapes √† tout moment."
      },
      {
        "phase": "C. Supprimer des colonnes",
        "methode_1": "Clic droit sur en-t√™te > Supprimer",
        "methode_2": "S√©lection > Accueil > Supprimer les colonnes",
        "methode_3": "Choisir les colonnes > Garder uniquement les colonnes s√©lectionn√©es"
      },
      {
        "phase": "D. Changer les types de donn√©es",
        "acces": "Clic sur l'ic√¥ne type dans l'en-t√™te (ABC, 123, üìÖ)",
        "types": [
          "Texte",
          "Nombre entier / D√©cimal",
          "Date / Date et heure",
          "Vrai/Faux"
        ]
      },
      {
        "phase": "E. Remplacer des valeurs",
        "acces": "Accueil > Remplacer les valeurs",
        "exemples": [
          "Remplacer 'N/A' par null",
          "Remplacer '$' par '' (rien)",
          "Remplacer ',' par '.' pour les d√©cimales"
        ]
      },
      {
        "phase": "F. Filtrer les lignes",
        "acces": "Clic sur la fl√®che de l'en-t√™te > Filtres",
        "options": [
          "Filtres texte : contient, commence par...",
          "Filtres num√©riques : sup√©rieur √†, entre...",
          "Supprimer les lignes vides"
        ]
      },
      {
        "phase": "G. Fusionner des requ√™tes",
        "acces": "Accueil > Fusionner des requ√™tes",
        "principe": "Comme RECHERCHEV mais plus puissant",
        "types_jointure": [
          "Externe gauche : garde tout √† gauche",
          "Interne : uniquement les correspondances",
          "Externe compl√®te : tout des deux c√¥t√©s"
        ]
      },
      {
        "phase": "H. Charger dans Excel",
        "acces": "Accueil > Fermer et charger",
        "options": [
          "Tableau : cr√©e un tableau Excel",
          "Connexion uniquement : garde en m√©moire sans charger",
          "Mod√®le de donn√©es : pour Power Pivot"
        ]
      }
    ],
  
    "checkpoints": [
      {
        "id": "cp_1_importer",
        "type": "power_query",
        "description": "Importer le fichier CSV dans Power Query",
        "competence_id": 30,
        "expected_action": "import",
        "points": 10,
        "indices": [
          "Donn√©es > Obtenir des donn√©es > √Ä partir d'un fichier CSV",
          "L'√©diteur Power Query s'ouvre",
          "Tu vois un aper√ßu des donn√©es"
        ]
      },
      {
        "id": "cp_2_supprimer_colonnes",
        "type": "power_query",
        "description": "Supprimer les colonnes inutiles",
        "competence_id": 30,
        "expected_columns_removed": ["ID_interne", "Code_legacy"],
        "points": 15,
        "indices": [
          "S√©lectionne les colonnes √† supprimer",
          "Clic droit > Supprimer les colonnes",
          "Ou : garder uniquement les colonnes utiles"
        ]
      },
      {
        "id": "cp_3_remplacer_na",
        "type": "power_query",
        "description": "Remplacer 'N/A' par null",
        "competence_id": 30,
        "expected_replacement": {"from": "N/A", "to": "null"},
        "points": 15,
        "indices": [
          "S√©lectionne la colonne Montant",
          "Accueil > Remplacer les valeurs",
          "'N/A' ‚Üí laisser vide (null)"
        ]
      },
      {
        "id": "cp_4_supprimer_dollar",
        "type": "power_query",
        "description": "Supprimer le symbole $ des montants",
        "competence_id": 30,
        "expected_replacement": {"from": "$", "to": ""},
        "points": 15,
        "indices": [
          "Remplacer '$' par '' (rien)",
          "Puis remplacer ',' par '.' si besoin",
          "Puis changer le type en Nombre"
        ]
      },
      {
        "id": "cp_5_type_date",
        "type": "power_query",
        "description": "Convertir la colonne Date en type Date",
        "competence_id": 30,
        "expected_type": "date",
        "points": 15,
        "indices": [
          "Clique sur l'ic√¥ne ABC dans l'en-t√™te Date",
          "Change en Date",
          "Power Query d√©tecte le format automatiquement"
        ]
      },
      {
        "id": "cp_6_fusionner",
        "type": "power_query",
        "description": "Fusionner avec la table R√©gions",
        "competence_id": 30,
        "expected_action": "merge",
        "points": 20,
        "indices": [
          "Accueil > Fusionner des requ√™tes",
          "S√©lectionne la colonne R√©gion dans les deux tables",
          "Jointure externe gauche",
          "D√©veloppe pour r√©cup√©rer Nom_FR"
        ]
      },
      {
        "id": "cp_7_charger",
        "type": "power_query",
        "description": "Charger le r√©sultat dans Excel",
        "competence_id": 30,
        "expected_action": "load",
        "points": 10,
        "indices": [
          "Accueil > Fermer et charger",
          "Un tableau Excel est cr√©√©",
          "La connexion est sauvegard√©e pour actualisation future"
        ]
      }
    ],
  
    "avantages_power_query": [
      "Reproductibilit√© : les √©tapes sont enregistr√©es",
      "Actualisation : un clic pour mettre √† jour",
      "Tra√ßabilit√© : historique des transformations",
      "Puissance : g√®re des millions de lignes",
      "Fusion : jointures comme en SQL"
    ],
  
    "etapes_courantes": {
      "nettoyage": [
        "Supprimer colonnes inutiles",
        "Supprimer lignes vides",
        "Supprimer doublons",
        "Remplacer erreurs"
      ],
      "transformation": [
        "Changer types de donn√©es",
        "Fractionner colonnes",
        "Pivoter/D√©pivoter",
        "Grouper par"
      ],
      "enrichissement": [
        "Fusionner des tables",
        "Ajouter colonnes calcul√©es",
        "Ajouter depuis exemples"
      ]
    },
  
    "scoring": {
      "total_points": 100,
      "seuil_reussite": 70,
      "seuil_maitrise": 90
    },
  
    "feedback_manager": {
      "succes": "F√©licitations ! Tu ma√Ætrises Power Query. Fini le nettoyage manuel r√©p√©titif. Un processus cr√©√© une fois, utilis√© pour toujours ! üîÑ",
      "partiel": "Bon d√©but ! Power Query est puissant. L'essentiel : importer, nettoyer, charger. Les √©tapes sont sauvegard√©es.",
      "echec": "Power Query automatise le nettoyage. Donn√©es > Obtenir des donn√©es pour commencer. Chaque transformation devient une √©tape r√©utilisable."
    },
  
    "socrate_message": {
      "intro": "Power Query, c'est la r√©volution du nettoyage de donn√©es ! üßπ Ce qui prenait des heures se fait en quelques clics, et surtout c'est reproductible.",
      "conclusion": "Tu connais maintenant l'outil ETL int√©gr√© √† Excel. Importer, transformer, charger - le workflow data analyst moderne. Game changer ! üéØ"
    },
  
    "metadata": {
      "version": "1.0",
      "created_at": "2026-01-21",
      "tags": ["Power Query", "ETL", "nettoyage", "transformation", "automatisation", "avanc√©"],
      "prerequis": ["Excel interm√©diaire", "Tableaux structur√©s"],
      "ouvre_vers": ["Power Query M", "Power Pivot", "Mod√®les de donn√©es"],
      "requires_excel": true,
      "excel_version": "2016+"
    }
  }