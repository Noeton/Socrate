{
    "id": "avance_05_decaler_plages_dynamiques",
    "titre": "DECALER : Cr√©er des Plages Dynamiques",
    "niveau": "avance",
    "duree_estimee": "25 min",
    "competences": ["DECALER", "Plages dynamiques", "Graphiques dynamiques"],
    "competence_ids": [28],
  
    "contexte": {
      "situation": "Tu es analyste chez TrendWatch, une soci√©t√© d'√©tudes de march√©. Tu dois cr√©er des graphiques qui s'adaptent automatiquement quand on ajoute des donn√©es. Le probl√®me : les plages fixes (A1:A12) ne s'√©tendent pas. DECALER permet de cr√©er des plages qui grandissent avec tes donn√©es.",
      "manager": {
        "nom": "Nicolas Fouquet",
        "poste": "Directeur des √âtudes",
        "personnalite": "Visionnaire, il veut des tableaux de bord qui vivent.",
        "demande": "Chaque mois on ajoute des donn√©es. Je ne veux plus avoir √† modifier les plages de mes graphiques et formules. √áa doit s'adapter tout seul !"
      },
      "enjeux": "Automatisation du reporting mensuel.",
      "deadline": "Avant la prochaine livraison de donn√©es"
    },
  
    "objectifs": [
      "Comprendre la syntaxe de DECALER",
      "Cr√©er des plages qui s'√©tendent automatiquement",
      "Utiliser DECALER avec NBVAL pour des plages dynamiques",
      "Appliquer aux graphiques et aux formules de synth√®se"
    ],
  
    "consignes": [
      "Ouvre le fichier avec les donn√©es de ventes mensuelles",
      "Cr√©e une formule SOMME avec plage dynamique",
      "Calcule une moyenne mobile avec DECALER",
      "Cr√©e des plages nomm√©es dynamiques pour les graphiques"
    ],
  
    "donnees": {
      "feuille": "Ventes",
      "headers": ["Mois", "CA", "Objectif"],
      "rows": [
        ["Jan", 45000, 40000],
        ["F√©v", 52000, 45000],
        ["Mar", 48000, 50000],
        ["Avr", 61000, 55000],
        ["Mai", 58000, 55000],
        ["Jun", 67000, 60000],
        ["Jul", 54000, 60000],
        ["Ao√ª", 49000, 50000],
        ["Sep", 72000, 65000],
        ["Oct", 78000, 70000],
        ["Nov", 85000, 75000],
        ["D√©c", 92000, 80000]
      ],
      "position": "A1:C13",
      "note": "On peut ajouter des lignes en bas"
    },
  
    "etapes": [
      {
        "phase": "A. Syntaxe DECALER",
        "syntaxe": "=DECALER(r√©f√©rence; lignes; colonnes; [hauteur]; [largeur])",
        "arguments": [
          "r√©f√©rence : point de d√©part (cellule ou plage)",
          "lignes : d√©calage vertical (+ = bas, - = haut)",
          "colonnes : d√©calage horizontal (+ = droite, - = gauche)",
          "hauteur : nombre de lignes de la plage r√©sultante",
          "largeur : nombre de colonnes de la plage r√©sultante"
        ]
      },
      {
        "phase": "B. DECALER simple - D√©caler une cellule",
        "exemple": "=DECALER(A1;2;1) ‚Üí cellule 2 lignes en bas, 1 colonne √† droite = B3",
        "usage": "R√©f√©rencer une cellule relative √† une autre"
      },
      {
        "phase": "C. DECALER avec dimensions - Cr√©er une plage",
        "exemple": "=DECALER(A1;0;0;5;1) ‚Üí plage de 5 lignes √ó 1 colonne √† partir de A1 = A1:A5",
        "usage": "Cr√©er une plage de taille sp√©cifique"
      },
      {
        "phase": "D. Plage dynamique avec NBVAL",
        "formule": "=DECALER(A1;0;0;NBVAL(A:A);1)",
        "explication": [
          "NBVAL(A:A) compte les cellules non vides en colonne A",
          "La hauteur de la plage = nombre de donn√©es",
          "Quand on ajoute des lignes, la plage s'agrandit !"
        ]
      },
      {
        "phase": "E. Moyenne mobile avec DECALER",
        "formule": "=MOYENNE(DECALER(B2;LIGNE()-2;0;-3;1))",
        "explication": "Moyenne des 3 derniers mois, qui se d√©cale avec la ligne"
      },
      {
        "phase": "F. Plage nomm√©e dynamique",
        "etapes": [
          "Formules > Gestionnaire de noms > Nouveau",
          "Nom : CA_Dynamique",
          "Fait r√©f√©rence √† : =DECALER(Ventes!$B$2;0;0;NBVAL(Ventes!$B:$B)-1;1)",
          "Utilise CA_Dynamique dans tes graphiques"
        ]
      }
    ],
  
    "checkpoints": [
      {
        "id": "cp_1_decaler_simple",
        "cellule": "F2",
        "type": "valeur",
        "description": "Valeur d√©cal√©e de 2 lignes, 1 colonne depuis A1",
        "competence_id": 28,
        "expected_value": 52000,
        "points": 10,
        "indices": [
          "=DECALER(A1;2;1) ‚Üí 2 lignes bas, 1 colonne droite",
          "A1 + 2 lignes = A3 (Mar), + 1 colonne = B3",
          "B3 = 48000... non, A1=header, donc A3=F√©v, B3=52000"
        ]
      },
      {
        "id": "cp_2_somme_dynamique",
        "cellule": "F3",
        "type": "formule",
        "description": "SOMME avec plage dynamique DECALER",
        "competence_id": 28,
        "fonction": "DECALER",
        "pattern": ["SOMME", "DECALER", "NBVAL"],
        "points": 25,
        "indices": [
          "=SOMME(DECALER(B1;1;0;NBVAL(B:B)-1;1))",
          "Commence en B2 (B1 d√©cal√© de 1)",
          "Hauteur = NBVAL(B:B)-1 pour exclure l'en-t√™te"
        ]
      },
      {
        "id": "cp_3_somme_resultat",
        "cellule": "F3",
        "type": "valeur",
        "description": "Somme totale CA (761000)",
        "competence_id": 28,
        "expected_value": 761000,
        "points": 10,
        "indices": [
          "Somme de Jan √† D√©c",
          "45000+52000+...+92000 = 761000",
          "Ta plage dynamique doit inclure toutes les donn√©es"
        ]
      },
      {
        "id": "cp_4_derniere_valeur",
        "cellule": "F4",
        "type": "valeur",
        "description": "Derni√®re valeur de CA (dynamique)",
        "competence_id": 28,
        "expected_value": 92000,
        "points": 20,
        "indices": [
          "=DECALER(B1;NBVAL(B:B)-1;0)",
          "D√©cale de (nombre de valeurs - 1) lignes",
          "D√©cembre = 92000"
        ]
      },
      {
        "id": "cp_5_moyenne_3mois",
        "cellule": "F5",
        "type": "valeur",
        "description": "Moyenne des 3 derniers mois",
        "competence_id": 28,
        "expected_value": 85000,
        "points": 20,
        "indices": [
          "Oct + Nov + D√©c = 78000 + 85000 + 92000 = 255000",
          "255000 / 3 = 85000",
          "=MOYENNE(DECALER(B1;NBVAL(B:B)-3;0;3;1))"
        ]
      },
      {
        "id": "cp_6_nb_mois",
        "cellule": "F6",
        "type": "valeur",
        "description": "Nombre de mois de donn√©es",
        "competence_id": 28,
        "expected_value": 12,
        "points": 15,
        "indices": [
          "=NBVAL(A:A)-1 ou =NBVAL(B:B)-1",
          "On enl√®ve 1 pour l'en-t√™te",
          "12 mois de donn√©es"
        ]
      }
    ],
  
    "applications_avancees": [
      {
        "cas": "Graphique dynamique",
        "methode": "Cr√©er une plage nomm√©e avec DECALER, l'utiliser comme source du graphique",
        "avantage": "Le graphique s'√©tend automatiquement"
      },
      {
        "cas": "Validation de donn√©es dynamique",
        "methode": "Source de liste = plage nomm√©e DECALER",
        "avantage": "Les nouvelles valeurs apparaissent dans la liste"
      },
      {
        "cas": "Top N dynamique",
        "methode": "=GRANDE.VALEUR(DECALER(...);N)",
        "avantage": "Top N sur une plage qui grandit"
      }
    ],
  
    "erreurs_frequentes": [
      {
        "erreur": "DECALER renvoie une valeur, pas une plage",
        "cause": "Hauteur et largeur non sp√©cifi√©es",
        "solution": "Ajoute les arguments 4 et 5 pour cr√©er une vraie plage"
      },
      {
        "erreur": "D√©calage de 1 en trop",
        "cause": "Oublier que DECALER(A1;1;0) va en A2, pas A1+1 lignes de donn√©es",
        "solution": "DECALER(A1;1;0) = A2. Pour N lignes de donn√©es depuis A2 : DECALER(A1;1;0;N;1)"
      }
    ],
  
    "scoring": {
      "total_points": 100,
      "seuil_reussite": 70,
      "seuil_maitrise": 90
    },
  
    "feedback_manager": {
      "succes": "Impressionnant ! DECALER n'a plus de secrets pour toi. Tes plages sont maintenant dynamiques et tes fichiers s'adaptent automatiquement ! üöÄ",
      "partiel": "Tu as compris le principe. DECALER cr√©e des plages flexibles. Combine avec NBVAL pour les rendre vraiment dynamiques.",
      "echec": "DECALER = cr√©er une plage √† partir d'un point de r√©f√©rence. Les 2 derniers arguments (hauteur, largeur) sont essentiels pour cr√©er des plages."
    },
  
    "socrate_message": {
      "intro": "DECALER, c'est la magie des plages dynamiques ! ‚ú® Tes formules et graphiques s'adaptent automatiquement quand les donn√©es changent.",
      "conclusion": "Tu ma√Ætrises DECALER ! Combin√© avec NBVAL, c'est l'outil ultime pour des fichiers qui vivent. Fini les plages √† modifier √† la main ! üéØ"
    },
  
    "metadata": {
      "version": "1.0",
      "created_at": "2026-01-21",
      "tags": ["DECALER", "OFFSET", "plages dynamiques", "graphiques", "avanc√©"],
      "prerequis": ["NBVAL", "R√©f√©rences absolues", "Plages nomm√©es"],
      "ouvre_vers": ["INDIRECT", "Tableaux structur√©s", "Power Query"]
    }
  }