{
    "id": "debutant_20_mfc_alertes",
    "titre": "Alertes Visuelles avec la Mise en Forme Conditionnelle",
    "niveau": "debutant",
    "duree_estimee": "20 min",
    "competences": ["Mise en forme conditionnelle", "Alertes visuelles"],
    "competence_ids": [10],
  
    "contexte": {
      "situation": "Tu g√®res le stock d'une boutique de fournitures de bureau, PapierPlus. Le g√©rant veut pouvoir voir d'un coup d'≈ìil les produits en rupture, les stocks faibles, et les meilleures ventes. Tu vas cr√©er un tableau de bord visuel avec des couleurs automatiques.",
      "manager": {
        "nom": "Antoine Leroy",
        "poste": "G√©rant de la boutique",
        "personnalite": "Visuel, il pr√©f√®re les couleurs aux chiffres. Il veut voir rouge quand il y a un probl√®me.",
        "demande": "Je n'ai pas le temps d'analyser tous les chiffres. Peux-tu faire en sorte que les probl√®mes de stock sautent aux yeux ? Rouge si c'est urgent, orange si √ßa commence √† baisser."
      },
      "enjeux": "√âviter les ruptures de stock qui font perdre des clients.",
      "deadline": "Pour l'inventaire de demain"
    },
  
    "objectifs": [
      "Cr√©er des r√®gles de mise en forme conditionnelle simples",
      "Utiliser les r√®gles pr√©d√©finies (sup√©rieur √†, inf√©rieur √†, entre)",
      "Ajouter des barres de donn√©es pour visualiser les quantit√©s",
      "Utiliser les jeux d'ic√¥nes (feux tricolores)"
    ],
  
    "consignes": [
      "Ouvre le fichier de stock",
      "Applique un fond ROUGE aux produits avec stock < 5 (rupture imminente)",
      "Applique un fond ORANGE aux produits avec stock entre 5 et 15 (stock faible)",
      "Applique un fond VERT aux produits avec stock > 50 (stock confortable)",
      "Ajoute des barres de donn√©es sur la colonne des ventes mensuelles",
      "Ajoute des ic√¥nes feux tricolores sur la colonne '√âtat'"
    ],
  
    "donnees": {
      "feuille": "Stock",
      "headers": ["R√©f√©rence", "Produit", "Cat√©gorie", "Stock", "Seuil alerte", "Ventes/mois", "√âtat"],
      "rows": [
        ["REF001", "Stylos bleus (x50)", "√âcriture", 3, 10, 45, null],
        ["REF002", "Cahiers A4 (x10)", "Papeterie", 25, 15, 32, null],
        ["REF003", "Post-it jaunes", "Bureau", 8, 10, 28, null],
        ["REF004", "Agrafeuse", "Mat√©riel", 52, 5, 8, null],
        ["REF005", "Trombones (x100)", "Bureau", 4, 10, 35, null],
        ["REF006", "Enveloppes C5 (x50)", "Papeterie", 67, 20, 22, null],
        ["REF007", "Correcteur blanc", "√âcriture", 12, 10, 18, null],
        ["REF008", "Classeurs A4", "Rangement", 2, 8, 41, null],
        ["REF009", "Surligneurs (x4)", "√âcriture", 35, 12, 25, null],
        ["REF010", "Ciseaux", "Mat√©riel", 18, 5, 12, null],
        ["REF011", "Colle stick", "Bureau", 6, 10, 30, null],
        ["REF012", "R√®gle 30cm", "Mat√©riel", 89, 10, 5, null],
        ["REF013", "Bloc-notes A5", "Papeterie", 14, 15, 38, null],
        ["REF014", "Feutres couleur (x12)", "√âcriture", 1, 8, 52, null],
        ["REF015", "Perforatrice", "Mat√©riel", 43, 5, 7, null]
      ]
    },
  
    "etapes": [
      {
        "phase": "A. Comprendre la MFC",
        "explications": [
          "La Mise en Forme Conditionnelle (MFC) change l'apparence d'une cellule selon sa valeur.",
          "Exemple : si stock < 5, fond rouge automatiquement.",
          "La MFC se met √† jour automatiquement quand les donn√©es changent."
        ],
        "acces": "Accueil > Mise en forme conditionnelle > R√®gles de mise en surbrillance"
      },
      {
        "phase": "B. R√®gle 'Stock critique' (rouge)",
        "consignes": [
          "S√©lectionne la colonne Stock (D2:D16)",
          "Accueil > Mise en forme conditionnelle > R√®gles de mise en surbrillance > Inf√©rieur √†...",
          "Entre : 5",
          "Choisis le format : Remplissage rouge clair avec texte rouge fonc√©",
          "OK - Les cellules < 5 deviennent rouges !"
        ]
      },
      {
        "phase": "C. R√®gle 'Stock faible' (orange)",
        "consignes": [
          "Garde la s√©lection D2:D16",
          "Mise en forme conditionnelle > R√®gles de mise en surbrillance > Entre...",
          "Entre : 5 et 15",
          "Choisis un format orange (personnalis√© si n√©cessaire)",
          "OK"
        ]
      },
      {
        "phase": "D. R√®gle 'Stock confortable' (vert)",
        "consignes": [
          "Garde la s√©lection D2:D16",
          "Mise en forme conditionnelle > R√®gles de mise en surbrillance > Sup√©rieur √†...",
          "Entre : 50",
          "Choisis un format vert",
          "OK"
        ]
      },
      {
        "phase": "E. Barres de donn√©es",
        "consignes": [
          "S√©lectionne la colonne Ventes/mois (F2:F16)",
          "Mise en forme conditionnelle > Barres de donn√©es > Barre bleue",
          "Les barres s'ajustent automatiquement √† la valeur max"
        ]
      },
      {
        "phase": "F. Jeux d'ic√¥nes",
        "consignes": [
          "En G2, cr√©e une formule : =SI(D2<E2;1;SI(D2<E2*2;2;3))",
          "Recopie jusqu'√† G16",
          "S√©lectionne G2:G16",
          "Mise en forme conditionnelle > Jeux d'ic√¥nes > 3 feux tricolores",
          "Personnalise : 1=rouge, 2=orange, 3=vert"
        ]
      }
    ],
  
    "checkpoints": [
      {
        "id": "cp_1_rouge_visible",
        "type": "graphique",
        "validation_type": "visual",
        "description": "Les stocks critiques (<5) sont en rouge",
        "competence_id": 10,
        "graph_type": "mfc",
        "requires_screenshot": true,
        "expected_data": {
          "description": "Les cellules de stock contenant 1, 2, 3 ou 4 doivent avoir un fond rouge ou rouge clair. Au moins 4 cellules doivent √™tre rouges (REF001, REF005, REF008, REF014).",
          "condition": "stock < 5",
          "color": "rouge",
          "cells_concerned": ["D2", "D6", "D9", "D15"]
        },
        "points": 25,
        "indices": [
          "S√©lectionne D2:D16 puis Mise en forme conditionnelle",
          "R√®gles de mise en surbrillance > Inf√©rieur √† > 5",
          "Choisis un format rouge"
        ]
      },
      {
        "id": "cp_2_orange_visible",
        "type": "graphique",
        "validation_type": "visual",
        "description": "Les stocks faibles (5-15) sont en orange",
        "competence_id": 10,
        "graph_type": "mfc",
        "requires_screenshot": true,
        "expected_data": {
          "description": "Les cellules de stock entre 5 et 15 doivent avoir un fond orange ou jaune. Cellules concern√©es : 6, 8, 12, 14 (REF003, REF007, REF011, REF013).",
          "condition": "5 <= stock <= 15",
          "color": "orange",
          "cells_concerned": ["D4", "D8", "D12", "D14"]
        },
        "points": 20,
        "indices": [
          "Utilise 'Entre...' dans les r√®gles",
          "Valeurs : 5 et 15",
          "Personnalise le format en orange si pas propos√©"
        ]
      },
      {
        "id": "cp_3_vert_visible",
        "type": "graphique",
        "validation_type": "visual",
        "description": "Les stocks confortables (>50) sont en vert",
        "competence_id": 10,
        "graph_type": "mfc",
        "requires_screenshot": true,
        "expected_data": {
          "description": "Les cellules de stock > 50 doivent √™tre en vert. Cellules : 52, 67, 89 (REF004, REF006, REF012).",
          "condition": "stock > 50",
          "color": "vert",
          "cells_concerned": ["D5", "D7", "D13"]
        },
        "points": 15,
        "indices": [
          "R√®gle : Sup√©rieur √† > 50",
          "Format vert",
          "3 produits devraient √™tre verts"
        ]
      },
      {
        "id": "cp_4_barres_donnees",
        "type": "graphique",
        "validation_type": "visual",
        "description": "Barres de donn√©es sur les ventes mensuelles",
        "competence_id": 10,
        "graph_type": "mfc",
        "requires_screenshot": true,
        "expected_data": {
          "description": "La colonne Ventes/mois (F) doit afficher des barres horizontales proportionnelles. La plus longue barre = 52 (REF014), la plus courte = 5 (REF012).",
          "type": "barres_donnees",
          "column": "F",
          "max_value": 52,
          "min_value": 5
        },
        "points": 20,
        "indices": [
          "S√©lectionne F2:F16",
          "Mise en forme conditionnelle > Barres de donn√©es",
          "Choisis une couleur (bleu, vert, ou autre)"
        ]
      },
      {
        "id": "cp_5_formule_etat",
        "cellule": "G2",
        "type": "formule",
        "description": "Formule pour calculer l'√©tat du stock",
        "competence_id": 9,
        "fonction": "SI",
        "pattern": ["SI", "D2", "E2"],
        "points": 10,
        "indices": [
          "Compare le stock (D2) au seuil (E2)",
          "Retourne 1 si critique, 2 si faible, 3 si OK",
          "=SI(D2<E2;1;SI(D2<E2*2;2;3))"
        ]
      },
      {
        "id": "cp_6_icones_visibles",
        "type": "graphique",
        "validation_type": "visual",
        "description": "Ic√¥nes feux tricolores dans la colonne √âtat",
        "competence_id": 10,
        "graph_type": "mfc",
        "requires_screenshot": true,
        "expected_data": {
          "description": "La colonne G doit afficher des ic√¥nes (feux tricolores, fl√®ches, ou symboles). Rouge pour √©tat=1, Orange/Jaune pour √©tat=2, Vert pour √©tat=3.",
          "type": "jeux_icones",
          "column": "G",
          "icone_type": "feux_tricolores"
        },
        "points": 10,
        "indices": [
          "Apr√®s la formule en G, s√©lectionne G2:G16",
          "Mise en forme conditionnelle > Jeux d'ic√¥nes",
          "Choisis les 3 feux tricolores"
        ]
      }
    ],
  
    "regles_mfc_recap": [
      {
        "type": "Mise en surbrillance",
        "regles": ["Sup√©rieur √†", "Inf√©rieur √†", "Entre", "√âgal √†", "Contient", "Date"]
      },
      {
        "type": "Barres de donn√©es",
        "description": "Barres proportionnelles dans les cellules"
      },
      {
        "type": "Nuances de couleurs",
        "description": "D√©grad√© de couleurs (heatmap)"
      },
      {
        "type": "Jeux d'ic√¥nes",
        "description": "Feux tricolores, fl√®ches, √©toiles, drapeaux..."
      }
    ],
  
    "scoring": {
      "total_points": 100,
      "seuil_reussite": 70,
      "seuil_maitrise": 90
    },
  
    "feedback_manager": {
      "succes": "Bravo ! Ton tableau de stock est maintenant super visuel. D'un coup d'≈ìil, on voit les urgences. C'est √ßa, un vrai dashboard ! üìäüé®",
      "partiel": "Bien jou√© pour les premi√®res r√®gles ! Continue avec les barres de donn√©es et les ic√¥nes pour un r√©sultat encore plus pro.",
      "echec": "La MFC est tr√®s visuelle, reprends l'exercice pas √† pas. Commence par une seule r√®gle (rouge si < 5) et v√©rifie qu'elle fonctionne."
    },
  
    "socrate_message": {
      "intro": "La mise en forme conditionnelle, c'est ce qui transforme un tableau de chiffres en dashboard visuel ! üé® Tu vas apprendre √† faire parler tes donn√©es avec des couleurs.",
      "conclusion": "Tu ma√Ætrises maintenant la MFC ! Rouge = danger, Orange = attention, Vert = OK. Tes tableaux ne seront plus jamais ennuyeux. üö¶"
    },
  
    "metadata": {
      "version": "1.0",
      "created_at": "2026-01-21",
      "tags": ["MFC", "mise en forme conditionnelle", "alertes", "couleurs", "barres de donn√©es", "ic√¥nes", "fondamental"],
      "prerequis": ["SI simple", "Formatage cellules"],
      "ouvre_vers": ["MFC avanc√©e", "Tableaux de bord"]
    }
  }