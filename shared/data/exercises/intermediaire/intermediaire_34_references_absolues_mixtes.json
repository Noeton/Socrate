{
    "id": "intermediaire_34_references_absolues_mixtes",
    "titre": "R√©f√©rences Absolues ($) et Mixtes : Ma√Ætriser la Recopie",
    "niveau": "intermediaire",
    "duree_estimee": "20 min",
    "competences": ["R√©f√©rences absolues", "R√©f√©rences mixtes", "Recopie de formules"],
    "competence_ids": [15, 51],
  
    "contexte": {
      "situation": "Tu es assistant(e) comptable chez ImportExport SA. Tu dois cr√©er une grille de conversion de devises qui se met √† jour automatiquement quand le taux change. Le probl√®me : quand tu recopies ta formule, les r√©f√©rences se d√©calent et tout devient faux !",
      "manager": {
        "nom": "Christine Lagarde",
        "poste": "Directrice Financi√®re",
        "personnalite": "Pr√©cise et m√©thodique, elle ne tol√®re aucune erreur de calcul.",
        "demande": "Je veux une grille de conversion EUR vers USD, GBP, JPY. Quand je change le taux, TOUTES les conversions doivent se mettre √† jour. Et je veux pouvoir recopier les formules sans tout casser."
      },
      "enjeux": "Erreur de conversion = perte financi√®re potentielle.",
      "deadline": "Pour le rapport mensuel"
    },
  
    "objectifs": [
      "Comprendre la diff√©rence entre r√©f√©rences relatives, absolues et mixtes",
      "Utiliser $ pour figer une ligne, une colonne, ou les deux",
      "Cr√©er des formules qui se recopient correctement",
      "Construire une table de conversion dynamique"
    ],
  
    "consignes": [
      "Ouvre le fichier avec les montants et les taux de change",
      "Cr√©e des formules de conversion qui se recopient sans erreur",
      "Utilise les r√©f√©rences absolues pour figer les taux",
      "Utilise les r√©f√©rences mixtes pour la grille de multiplication"
    ],
  
    "donnees": {
      "feuille": "Conversions",
      "taux_change": {
        "position": "F1:G4",
        "headers": ["Devise", "Taux"],
        "rows": [
          ["USD", 1.08],
          ["GBP", 0.86],
          ["JPY", 162.50]
        ]
      },
      "montants_eur": {
        "position": "A1:A6",
        "values": ["Montant EUR", 100, 250, 500, 1000, 5000]
      },
      "grille_conversion": {
        "position": "A1:D6",
        "description": "Grille avec montants en lignes, devises en colonnes"
      }
    },
  
    "etapes": [
      {
        "phase": "A. Types de r√©f√©rences",
        "types": [
          "A1 ‚Üí Relative : se d√©cale quand on recopie",
          "$A$1 ‚Üí Absolue : ne bouge JAMAIS",
          "$A1 ‚Üí Mixte colonne : colonne fig√©e, ligne se d√©cale",
          "A$1 ‚Üí Mixte ligne : ligne fig√©e, colonne se d√©cale"
        ],
        "raccourci": "F4 pour basculer entre les modes (A1 ‚Üí $A$1 ‚Üí A$1 ‚Üí $A1 ‚Üí A1)"
      },
      {
        "phase": "B. R√©f√©rence relative (par d√©faut)",
        "exemple": "=A1*2 recopi√© vers le bas devient =A2*2, =A3*2...",
        "usage": "Quand tu veux que la formule s'adapte √† chaque ligne"
      },
      {
        "phase": "C. R√©f√©rence absolue ($A$1)",
        "exemple": "=A1*$G$2 ‚Üí le taux en G2 reste fixe m√™me si on recopie",
        "usage": "Pour figer une cellule de param√®tre (taux, TVA, constante)"
      },
      {
        "phase": "D. R√©f√©rence mixte colonne ($A1)",
        "exemple": "=$A1*B$1 ‚Üí A est fig√©, la ligne se d√©cale",
        "usage": "Grille de multiplication : figer la colonne des montants"
      },
      {
        "phase": "E. R√©f√©rence mixte ligne (A$1)",
        "exemple": "=$A1*B$1 ‚Üí la ligne 1 (taux) est fig√©e",
        "usage": "Grille de multiplication : figer la ligne des taux"
      },
      {
        "phase": "F. Combiner pour une grille",
        "formule": "=$A2*B$1",
        "explication": [
          "$A2 : colonne A fig√©e (montants), ligne se d√©cale",
          "B$1 : ligne 1 fig√©e (taux), colonne se d√©cale",
          "Recopie vers droite ET vers bas = grille compl√®te !"
        ]
      }
    ],
  
    "checkpoints": [
      {
        "id": "cp_1_conversion_simple",
        "cellule": "B2",
        "type": "valeur",
        "description": "100 EUR en USD",
        "competence_id": 15,
        "expected_value": 108,
        "points": 10,
        "indices": [
          "100 EUR √ó 1.08 = 108 USD",
          "=A2*taux_USD",
          "Le taux USD est en G2"
        ]
      },
      {
        "id": "cp_2_reference_absolue",
        "cellule": "B2",
        "type": "formule",
        "description": "Formule avec r√©f√©rence absolue pour le taux",
        "competence_id": 15,
        "pattern": ["$G$2", "A2"],
        "alternative_patterns": [["$", "G", "2"]],
        "points": 20,
        "indices": [
          "Le taux doit √™tre en r√©f√©rence absolue",
          "=A2*$G$2",
          "$ avant G ET avant 2"
        ]
      },
      {
        "id": "cp_3_recopie_bas",
        "cellule": "B6",
        "type": "valeur",
        "description": "5000 EUR en USD (recopi√©)",
        "competence_id": 15,
        "expected_value": 5400,
        "points": 15,
        "indices": [
          "5000 √ó 1.08 = 5400",
          "La formule recopi√©e doit garder $G$2",
          "Mais A2 devient A6"
        ]
      },
      {
        "id": "cp_4_grille_mixte",
        "cellule": "B2",
        "type": "formule",
        "description": "Formule mixte pour grille (si grille en B2:D6)",
        "competence_id": 51,
        "pattern": ["$A", "B$1"],
        "alternative_patterns": [["$A2", "$1"]],
        "points": 25,
        "indices": [
          "Colonne A fig√©e : $A2",
          "Ligne 1 fig√©e : B$1",
          "=$A2*B$1"
        ]
      },
      {
        "id": "cp_5_coin_grille",
        "cellule": "D6",
        "type": "valeur",
        "description": "5000 EUR en JPY (coin de grille)",
        "competence_id": 51,
        "expected_value": 812500,
        "points": 15,
        "indices": [
          "5000 √ó 162.50 = 812500",
          "La formule en D6 doit √™tre =$A6*D$1",
          "V√©rifie que ta grille est coh√©rente"
        ]
      },
      {
        "id": "cp_6_milieu_grille",
        "cellule": "C4",
        "type": "valeur",
        "description": "500 EUR en GBP",
        "competence_id": 51,
        "expected_value": 430,
        "points": 15,
        "indices": [
          "500 √ó 0.86 = 430",
          "Formule : =$A4*C$1",
          "A4=500, C1=0.86"
        ]
      }
    ],
  
    "tableau_recap": {
      "titre": "Quand utiliser quoi ?",
      "cas": [
        {
          "situation": "Param√®tre fixe (TVA, taux, constante)",
          "reference": "$A$1",
          "exemple": "=B2*$G$1 o√π G1 contient la TVA"
        },
        {
          "situation": "Grille : colonne de r√©f√©rence",
          "reference": "$A1",
          "exemple": "=$A2*B1 ‚Üí colonne A fig√©e"
        },
        {
          "situation": "Grille : ligne de r√©f√©rence",
          "reference": "A$1",
          "exemple": "=A2*B$1 ‚Üí ligne 1 fig√©e"
        },
        {
          "situation": "Formule standard √† recopier",
          "reference": "A1",
          "exemple": "=A1+B1 ‚Üí s'adapte √† chaque ligne"
        }
      ]
    },
  
    "erreurs_frequentes": [
      {
        "erreur": "Oublier $ et voir #REF! ou 0",
        "cause": "La r√©f√©rence se d√©cale vers une cellule vide ou invalide",
        "solution": "Ajoute $ avant la lettre et/ou le chiffre √† figer"
      },
      {
        "erreur": "Mettre $ partout",
        "cause": "La formule ne s'adapte plus du tout",
        "solution": "R√©fl√©chis : qu'est-ce qui doit bouger, qu'est-ce qui doit rester fixe ?"
      }
    ],
  
    "scoring": {
      "total_points": 100,
      "seuil_reussite": 70,
      "seuil_maitrise": 90
    },
  
    "feedback_manager": {
      "succes": "Excellent ! Tu ma√Ætrises les r√©f√©rences absolues et mixtes. Tes formules se recopient parfaitement maintenant ! üîí",
      "partiel": "Tu as compris le principe. Rappel : $ fige ce qui suit. $A = colonne fig√©e, $1 = ligne fig√©e, $A$1 = tout fig√©.",
      "echec": "Les $ sont essentiels pour les formules qui se recopient. F4 est ton ami pour basculer entre les modes !"
    },
  
    "socrate_message": {
      "intro": "Les r√©f√©rences absolues, c'est LE concept qui fait la diff√©rence entre d√©butant et interm√©diaire ! üéØ Sans √ßa, impossible de cr√©er des formules robustes.",
      "conclusion": "Tu ma√Ætrises maintenant le $. Relatif, absolu, mixte... tu sais quand utiliser quoi. Tes tableaux Excel vont devenir beaucoup plus puissants ! üí™"
    },
  
    "metadata": {
      "version": "1.0",
      "created_at": "2026-01-21",
      "tags": ["r√©f√©rences absolues", "r√©f√©rences mixtes", "$", "recopie", "interm√©diaire"],
      "prerequis": ["Formules de base", "Recopie"],
      "ouvre_vers": ["Grilles complexes", "Tableaux de bord", "INDIRECT"]
    }
  }