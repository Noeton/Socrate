{
    "id": "intermediaire_33_fonctions_texte_manipulation",
    "titre": "Fonctions Texte : Manipuler et Transformer les Donn√©es",
    "niveau": "intermediaire",
    "duree_estimee": "22 min",
    "competences": ["CONCATENER", "CONCAT", "GAUCHE", "DROITE", "STXT", "CHERCHE", "NBCAR"],
    "competence_ids": [19, 20],
  
    "contexte": {
      "situation": "Tu travailles au service client de T√©l√©comPlus. Les donn√©es clients arrivent en vrac : noms en majuscules, pr√©noms et noms coll√©s, codes clients mal format√©s... Tu dois nettoyer et restructurer ces donn√©es pour les importer dans le nouveau CRM.",
      "manager": {
        "nom": "Fatima Benali",
        "poste": "Responsable Base de Donn√©es",
        "personnalite": "Perfectionniste sur la qualit√© des donn√©es, elle refuse les imports mal format√©s.",
        "demande": "J'ai 5000 lignes √† nettoyer. Les noms sont en MAJUSCULES, les codes clients n'ont pas le bon format, et je dois s√©parer pr√©nom/nom. Tu peux automatiser √ßa avec des formules ?"
      },
      "enjeux": "Migration CRM bloqu√©e tant que les donn√©es ne sont pas propres.",
      "deadline": "Import pr√©vu lundi"
    },
  
    "objectifs": [
      "Concat√©ner des textes avec CONCATENER, CONCAT et &",
      "Extraire des parties de texte avec GAUCHE, DROITE, STXT",
      "Trouver la position d'un caract√®re avec CHERCHE/TROUVE",
      "Compter les caract√®res avec NBCAR",
      "Transformer la casse avec MAJUSCULE, MINUSCULE, NOMPROPRE"
    ],
  
    "consignes": [
      "Ouvre le fichier avec les donn√©es clients √† nettoyer",
      "S√©pare les pr√©noms et noms qui sont coll√©s",
      "Reformate les codes clients au bon format",
      "Cr√©e des adresses email standardis√©es",
      "Nettoie et transforme les donn√©es texte"
    ],
  
    "donnees": {
      "feuille": "Clients",
      "headers": ["ID", "Nom_Complet", "Code_Brut", "Telephone", "Ville"],
      "rows": [
        ["1", "MARTIN Sophie", "cli001234", "0612345678", "PARIS"],
        ["2", "DUBOIS Thomas", "cli005678", "0698765432", "LYON"],
        ["3", "BERNARD Claire", "cli009012", "0654321098", "MARSEILLE"],
        ["4", "PETIT Lucas", "cli003456", "0687654321", "BORDEAUX"],
        ["5", "ROBERT Emma", "cli007890", "0621098765", "TOULOUSE"],
        ["6", "DURAND Marc", "cli002345", "0643210987", "NANTES"],
        ["7", "LEROY Julie", "cli006789", "0676543210", "STRASBOURG"],
        ["8", "MOREAU Antoine", "cli000123", "0609876543", "LILLE"]
      ],
      "position": "A1:E9",
      "objectif_format": {
        "code_client": "CLI-XXXX (majuscules, tiret, 4 chiffres)",
        "email": "prenom.nom@telecomplus.fr (tout en minuscules)",
        "nom_propre": "Sophie Martin (Nompropre)"
      }
    },
  
    "etapes": [
      {
        "phase": "A. Concat√©nation - Assembler des textes",
        "methodes": [
          "Op√©rateur & : =A1&\" \"&B1 ‚Üí assemble A1, espace, B1",
          "CONCATENER : =CONCATENER(A1;\" \";B1) ‚Üí m√™me r√©sultat",
          "CONCAT : =CONCAT(A1;\" \";B1) ‚Üí version moderne (Excel 2016+)"
        ],
        "exemple": "=CONCATENER(\"Bonjour \";A2;\" !\") ‚Üí 'Bonjour Sophie !'"
      },
      {
        "phase": "B. GAUCHE - Extraire depuis le d√©but",
        "syntaxe": "=GAUCHE(texte; nb_caract√®res)",
        "exemple": "=GAUCHE(\"cli001234\";3) ‚Üí 'cli'",
        "usage": "Extraire un pr√©fixe, un code, les premi√®res lettres"
      },
      {
        "phase": "C. DROITE - Extraire depuis la fin",
        "syntaxe": "=DROITE(texte; nb_caract√®res)",
        "exemple": "=DROITE(\"cli001234\";6) ‚Üí '001234'",
        "usage": "Extraire un suffixe, les derniers chiffres"
      },
      {
        "phase": "D. STXT - Extraire au milieu",
        "syntaxe": "=STXT(texte; position_d√©but; nb_caract√®res)",
        "exemple": "=STXT(\"cli001234\";4;4) ‚Üí '0012' (commence position 4, prend 4 car.)",
        "usage": "Extraire une partie sp√©cifique"
      },
      {
        "phase": "E. CHERCHE - Trouver la position d'un caract√®re",
        "syntaxe": "=CHERCHE(caract√®re; texte; [d√©but])",
        "exemple": "=CHERCHE(\" \";\"MARTIN Sophie\") ‚Üí 7 (l'espace est en position 7)",
        "usage": "Trouver o√π couper un texte (ex: s√©parer pr√©nom/nom)"
      },
      {
        "phase": "F. NBCAR - Compter les caract√®res",
        "syntaxe": "=NBCAR(texte)",
        "exemple": "=NBCAR(\"Sophie\") ‚Üí 6",
        "usage": "Calculer la longueur pour DROITE dynamique"
      },
      {
        "phase": "G. Transformation de casse",
        "fonctions": [
          "MAJUSCULE(texte) ‚Üí TOUT EN MAJUSCULES",
          "MINUSCULE(texte) ‚Üí tout en minuscules",
          "NOMPROPRE(texte) ‚Üí Premi√®re Lettre En Majuscule"
        ]
      },
      {
        "phase": "H. Combiner pour s√©parer pr√©nom/nom",
        "probleme": "S√©parer 'MARTIN Sophie' en nom et pr√©nom",
        "solution_nom": "=GAUCHE(B2;CHERCHE(\" \";B2)-1) ‚Üí 'MARTIN'",
        "solution_prenom": "=STXT(B2;CHERCHE(\" \";B2)+1;100) ‚Üí 'Sophie'",
        "explication": "CHERCHE trouve l'espace, GAUCHE/STXT extraient avant/apr√®s"
      }
    ],
  
    "checkpoints": [
      {
        "id": "cp_1_code_formate",
        "cellule": "G2",
        "type": "valeur",
        "description": "Code client reformat√© (CLI-1234)",
        "competence_id": 19,
        "expected_value": "CLI-1234",
        "points": 15,
        "indices": [
          "Extraire les 4 derniers chiffres avec DROITE",
          "Concat√©ner avec 'CLI-'",
          "=CONCAT(\"CLI-\";DROITE(C2;4)) ou =\"CLI-\"&DROITE(C2;4)"
        ]
      },
      {
        "id": "cp_2_formule_concat",
        "cellule": "G2",
        "type": "formule",
        "description": "Utilisation de concat√©nation",
        "competence_id": 19,
        "pattern": ["DROITE", "CLI"],
        "points": 10,
        "indices": [
          "Combine DROITE et concat√©nation",
          "& ou CONCAT ou CONCATENER",
          "Extrait les 4 derniers caract√®res"
        ]
      },
      {
        "id": "cp_3_nom_seul",
        "cellule": "H2",
        "type": "valeur",
        "description": "Extraction du nom (avant l'espace)",
        "competence_id": 20,
        "expected_value": "MARTIN",
        "points": 15,
        "indices": [
          "Le nom est avant l'espace",
          "CHERCHE(\" \";B2) trouve la position de l'espace",
          "=GAUCHE(B2;CHERCHE(\" \";B2)-1)"
        ]
      },
      {
        "id": "cp_4_prenom_seul",
        "cellule": "I2",
        "type": "valeur",
        "description": "Extraction du pr√©nom (apr√®s l'espace)",
        "competence_id": 20,
        "expected_value": "Sophie",
        "points": 15,
        "indices": [
          "Le pr√©nom est apr√®s l'espace",
          "=STXT(B2;CHERCHE(\" \";B2)+1;100)",
          "Ou =DROITE(B2;NBCAR(B2)-CHERCHE(\" \";B2))"
        ]
      },
      {
        "id": "cp_5_email",
        "cellule": "J2",
        "type": "valeur",
        "description": "Email g√©n√©r√© (prenom.nom@telecomplus.fr)",
        "competence_id": 19,
        "expected_value": "sophie.martin@telecomplus.fr",
        "points": 20,
        "indices": [
          "Format : prenom.nom@telecomplus.fr en minuscules",
          "Utilise MINUSCULE pour tout mettre en minuscules",
          "=MINUSCULE(I2&\".\"&H2&\"@telecomplus.fr\")"
        ]
      },
      {
        "id": "cp_6_nom_propre",
        "cellule": "K2",
        "type": "valeur",
        "description": "Nom complet en NomPropre",
        "competence_id": 20,
        "expected_value": "Martin Sophie",
        "points": 10,
        "indices": [
          "NOMPROPRE met la 1√®re lettre en majuscule",
          "=NOMPROPRE(B2)",
          "'MARTIN Sophie' ‚Üí 'Martin Sophie'"
        ]
      },
      {
        "id": "cp_7_telephone_formate",
        "cellule": "L2",
        "type": "valeur",
        "description": "T√©l√©phone format√© (06 12 34 56 78)",
        "competence_id": 20,
        "expected_value": "06 12 34 56 78",
        "points": 15,
        "indices": [
          "Ins√©rer des espaces tous les 2 chiffres",
          "=GAUCHE(D2;2)&\" \"&STXT(D2;3;2)&\" \"&STXT(D2;5;2)&\" \"&STXT(D2;7;2)&\" \"&DROITE(D2;2)",
          "Ou utiliser SUBSTITUE avec un peu de magie"
        ]
      }
    ],
  
    "fonctions_complementaires": [
      {
        "fonction": "SUPPRESPACE(texte)",
        "description": "Supprime les espaces en trop",
        "exemple": "=SUPPRESPACE(\"  Sophie  Martin  \") ‚Üí 'Sophie Martin'"
      },
      {
        "fonction": "SUBSTITUE(texte;ancien;nouveau)",
        "description": "Remplace un texte par un autre",
        "exemple": "=SUBSTITUE(\"cli001234\";\"cli\";\"CLI-\") ‚Üí 'CLI-001234'"
      },
      {
        "fonction": "TEXTE(valeur;format)",
        "description": "Formate un nombre en texte",
        "exemple": "=TEXTE(1234;\"0000\") ‚Üí '1234' avec z√©ros de t√™te"
      },
      {
        "fonction": "CNUM(texte)",
        "description": "Convertit un texte en nombre",
        "exemple": "=CNUM(\"1234\") ‚Üí 1234 (nombre)"
      }
    ],
  
    "erreurs_frequentes": [
      {
        "erreur": "STXT avec position 0",
        "probleme": "Les positions commencent √† 1, pas 0",
        "solution": "=STXT(texte;1;5) pour les 5 premiers caract√®res"
      },
      {
        "erreur": "CHERCHE sensible √† la casse",
        "note": "CHERCHE n'est PAS sensible, TROUVE est sensible",
        "solution": "Utilise CHERCHE pour ignorer la casse"
      },
      {
        "erreur": "Oublier de soustraire 1 avec GAUCHE+CHERCHE",
        "probleme": "=GAUCHE(B2;CHERCHE(\" \";B2)) inclut l'espace",
        "solution": "=GAUCHE(B2;CHERCHE(\" \";B2)-1)"
      }
    ],
  
    "scoring": {
      "total_points": 100,
      "seuil_reussite": 70,
      "seuil_maitrise": 90
    },
  
    "feedback_manager": {
      "succes": "Excellent ! Tu ma√Ætrises les fonctions texte. Tu peux nettoyer et transformer n'importe quelle donn√©e maintenant ! ‚ú®",
      "partiel": "Bon travail ! Les combinaisons CHERCHE+GAUCHE/STXT demandent de la pratique. N'oublie pas le -1 pour exclure le s√©parateur.",
      "echec": "Les fonctions texte sont nombreuses mais logiques. GAUCHE/DROITE pour les extr√©mit√©s, STXT pour le milieu, CHERCHE pour trouver o√π couper."
    },
  
    "socrate_message": {
      "intro": "Les fonctions texte, c'est la trousse √† outils du nettoyage de donn√©es ! üßπ Extraire, assembler, transformer... tout est possible.",
      "conclusion": "Tu sais maintenant manipuler le texte comme un pro. Donn√©es sales ? Plus de probl√®me ! GAUCHE, DROITE, STXT, CHERCHE = combo gagnant ! üéØ"
    },
  
    "metadata": {
      "version": "1.0",
      "created_at": "2026-01-21",
      "tags": ["texte", "CONCATENER", "GAUCHE", "DROITE", "STXT", "CHERCHE", "nettoyage", "interm√©diaire"],
      "prerequis": ["Formules de base"],
      "ouvre_vers": ["TEXTJOIN", "Expressions r√©guli√®res", "Power Query"]
    }
  }