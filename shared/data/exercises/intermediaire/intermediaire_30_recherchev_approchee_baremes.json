{
    "id": "intermediaire_30_recherchev_approchee_baremes",
    "titre": "RECHERCHEV Approch√©e : Bar√®mes et Tranches Automatiques",
    "niveau": "intermediaire",
    "duree_estimee": "20 min",
    "competences": ["RECHERCHEV approch√©e", "Bar√®mes", "Tranches"],
    "competence_ids": [53],
  
    "contexte": {
      "situation": "Tu travailles au service paie de TechSolutions. L'entreprise applique des primes d'anciennet√© selon un bar√®me progressif. Tu dois automatiser le calcul des primes pour 150 employ√©s.",
      "manager": {
        "nom": "St√©phane Morel",
        "poste": "Responsable Paie",
        "personnalite": "M√©thodique, il veut des calculs 100% fiables pour √©viter les erreurs de paie.",
        "demande": "Notre bar√®me de prime d'anciennet√© a 6 tranches. Je ne veux pas faire 150 SI imbriqu√©s ! Il doit y avoir une m√©thode plus simple avec RECHERCHEV, non ?"
      },
      "enjeux": "Erreur de paie = m√©contentement des employ√©s + risque prud'homal.",
      "deadline": "Avant la cl√¥ture de paie vendredi"
    },
  
    "objectifs": [
      "Comprendre la diff√©rence entre RECHERCHEV exacte (FAUX) et approch√©e (VRAI)",
      "Utiliser RECHERCHEV approch√©e pour des bar√®mes √† tranches",
      "Construire une table de r√©f√©rence tri√©e correctement",
      "Appliquer cette technique aux imp√¥ts, commissions, remises..."
    ],
  
    "consignes": [
      "Ouvre le fichier avec la liste des employ√©s et le bar√®me de primes",
      "Utilise RECHERCHEV approch√©e pour trouver automatiquement la tranche",
      "Calcule la prime pour chaque employ√©",
      "V√©rifie les cas limites (0 an, 5 ans exactement, 20+ ans)"
    ],
  
    "donnees": {
      "feuille": "Paie",
      "bareme_primes": {
        "description": "Prime mensuelle selon anciennet√©",
        "table": [
          {"anciennete_min": 0, "prime": 0, "description": "Moins de 2 ans"},
          {"anciennete_min": 2, "prime": 50, "description": "2 √† 4 ans"},
          {"anciennete_min": 5, "prime": 100, "description": "5 √† 9 ans"},
          {"anciennete_min": 10, "prime": 200, "description": "10 √† 14 ans"},
          {"anciennete_min": 15, "prime": 350, "description": "15 √† 19 ans"},
          {"anciennete_min": 20, "prime": 500, "description": "20 ans et plus"}
        ],
        "position": "G1:H7"
      },
      "employes": {
        "headers": ["ID", "Nom", "Date embauche", "Anciennet√©", "Prime"],
        "rows": [
          ["E001", "Martin Alice", "15/03/2023", 1.8, null],
          ["E002", "Dubois Pierre", "01/09/2019", 5.4, null],
          ["E003", "Bernard Marie", "20/06/2010", 14.6, null],
          ["E004", "Thomas Lucas", "05/01/2004", 21.0, null],
          ["E005", "Robert Emma", "30/11/2021", 3.1, null],
          ["E006", "Petit Jean", "15/07/2017", 7.5, null],
          ["E007", "Durand Sophie", "01/03/2015", 9.8, null],
          ["E008", "Leroy Hugo", "20/08/2009", 15.4, null],
          ["E009", "Moreau Claire", "10/04/2022", 2.8, null],
          ["E010", "Simon Antoine", "25/12/1999", 25.1, null]
        ]
      }
    },
  
    "etapes": [
      {
        "phase": "A. Comprendre RECHERCHEV approch√©e",
        "explications": [
          "RECHERCHEV exacte (FAUX) : cherche une correspondance EXACTE, sinon #N/A",
          "RECHERCHEV approch√©e (VRAI) : cherche la plus grande valeur <= √† ta recherche",
          "Parfait pour les tranches : 7 ans ‚Üí trouve 5 (car 5 <= 7 < 10)"
        ],
        "condition_critique": "‚ö†Ô∏è La table DOIT √™tre tri√©e par ordre CROISSANT sur la 1√®re colonne !"
      },
      {
        "phase": "B. Construire la table de bar√®me",
        "consignes": [
          "En G1:H1, mets les en-t√™tes : Anciennet√©, Prime",
          "En G2:H7, saisis le bar√®me (valeurs minimales de chaque tranche)",
          "IMPORTANT : les valeurs de G doivent √™tre tri√©es croissant (0, 2, 5, 10, 15, 20)"
        ],
        "table": [
          ["0", "0"],
          ["2", "50"],
          ["5", "100"],
          ["10", "200"],
          ["15", "350"],
          ["20", "500"]
        ]
      },
      {
        "phase": "C. Appliquer RECHERCHEV approch√©e",
        "syntaxe": "=RECHERCHEV(valeur; table; colonne; VRAI)",
        "consignes": [
          "En E2 (Prime de Martin), tape :",
          "=RECHERCHEV(D2;$G$2:$H$7;2;VRAI)",
          "D2 = anciennet√© (1.8 ans)",
          "VRAI = mode approch√©",
          "R√©sultat : 0‚Ç¨ (car 1.8 < 2, donc tranche 0)"
        ]
      },
      {
        "phase": "D. V√©rifier les cas limites",
        "tests": [
          "1.8 ans ‚Üí 0‚Ç¨ (tranche 0-2)",
          "5.0 ans exactement ‚Üí 100‚Ç¨ (tranche 5-10, inclus)",
          "9.8 ans ‚Üí 100‚Ç¨ (encore tranche 5-10)",
          "10.0 ans ‚Üí 200‚Ç¨ (passe √† tranche 10-15)",
          "25 ans ‚Üí 500‚Ç¨ (tranche 20+)"
        ]
      }
    ],
  
    "checkpoints": [
      {
        "id": "cp_1_bareme_table",
        "cellule": "H3",
        "type": "valeur",
        "description": "Table bar√®me correcte (prime 2-5 ans)",
        "competence_id": 53,
        "expected_value": 50,
        "points": 10,
        "indices": [
          "La tranche 2-5 ans donne 50‚Ç¨",
          "En G3 tu dois avoir 2, en H3 tu dois avoir 50",
          "V√©rifie que la table est tri√©e croissant"
        ]
      },
      {
        "id": "cp_2_prime_moins_2ans",
        "cellule": "E2",
        "type": "valeur",
        "description": "Prime pour anciennet√© < 2 ans (0‚Ç¨)",
        "competence_id": 53,
        "expected_value": 0,
        "points": 15,
        "indices": [
          "Martin a 1.8 ans d'anciennet√©",
          "1.8 < 2, donc tranche 0 ‚Üí prime 0‚Ç¨",
          "=RECHERCHEV(D2;$G$2:$H$7;2;VRAI)"
        ]
      },
      {
        "id": "cp_3_prime_5ans",
        "cellule": "E3",
        "type": "valeur",
        "description": "Prime pour anciennet√© 5+ ans",
        "competence_id": 53,
        "expected_value": 100,
        "points": 15,
        "indices": [
          "Dubois a 5.4 ans",
          "5.4 >= 5 mais < 10 ‚Üí tranche 5 ‚Üí 100‚Ç¨",
          "RECHERCHEV trouve 5 (plus grande valeur <= 5.4)"
        ]
      },
      {
        "id": "cp_4_prime_14ans",
        "cellule": "E4",
        "type": "valeur",
        "description": "Prime pour anciennet√© 14+ ans",
        "competence_id": 53,
        "expected_value": 200,
        "points": 15,
        "indices": [
          "Bernard a 14.6 ans",
          "14.6 >= 10 mais < 15 ‚Üí tranche 10 ‚Üí 200‚Ç¨",
          "Pas encore dans la tranche 15"
        ]
      },
      {
        "id": "cp_5_prime_20plus",
        "cellule": "E5",
        "type": "valeur",
        "description": "Prime pour anciennet√© 20+ ans",
        "competence_id": 53,
        "expected_value": 500,
        "points": 15,
        "indices": [
          "Thomas a 21 ans d'anciennet√©",
          "21 >= 20 ‚Üí tranche maximale ‚Üí 500‚Ç¨",
          "C'est le plafond du bar√®me"
        ]
      },
      {
        "id": "cp_6_formule_recherchev",
        "cellule": "E2",
        "type": "formule",
        "description": "Formule RECHERCHEV approch√©e correcte",
        "competence_id": 53,
        "fonction": "RECHERCHEV",
        "pattern": ["RECHERCHEV", "D2", "VRAI"],
        "points": 20,
        "indices": [
          "Ta formule doit contenir RECHERCHEV",
          "Le 4√®me argument doit √™tre VRAI (approch√©)",
          "=RECHERCHEV(D2;$G$2:$H$7;2;VRAI)"
        ]
      },
      {
        "id": "cp_7_prime_dernier",
        "cellule": "E11",
        "type": "valeur",
        "description": "Prime du dernier employ√© (25+ ans)",
        "competence_id": 53,
        "expected_value": 500,
        "points": 10,
        "indices": [
          "Simon a 25.1 ans d'anciennet√©",
          "Maximum du bar√®me",
          "V√©rifie que la formule est recopi√©e"
        ]
      }
    ],
  
    "comparaison_modes": {
      "faux_exact": {
        "usage": "Codes, identifiants, noms exacts",
        "comportement": "Cherche correspondance exacte ou #N/A",
        "exemple": "Trouver le prix du produit 'ABC123'"
      },
      "vrai_approche": {
        "usage": "Bar√®mes, tranches, seuils",
        "comportement": "Trouve la plus grande valeur <= recherche",
        "exemple": "Trouver la tranche d'imp√¥t pour 35000‚Ç¨",
        "condition": "Table OBLIGATOIREMENT tri√©e croissant"
      }
    },
  
    "applications_courantes": [
      "Bar√®mes d'imp√¥t sur le revenu",
      "Grilles de commissions commerciales",
      "Remises par volume d'achat",
      "Frais de port par poids",
      "Notes et mentions selon les points",
      "Tarifs d√©gressifs"
    ],
  
    "erreurs_frequentes": [
      {
        "erreur": "Table non tri√©e",
        "symptome": "R√©sultats incoh√©rents ou erron√©s",
        "solution": "Trier la table par ordre CROISSANT sur la 1√®re colonne"
      },
      {
        "erreur": "Oublier VRAI",
        "symptome": "#N/A car valeur exacte non trouv√©e",
        "solution": "Ajouter VRAI comme 4√®me argument"
      },
      {
        "erreur": "Commencer √† 1 au lieu de 0",
        "symptome": "Valeurs < 1 renvoient #N/A",
        "solution": "La 1√®re ligne du bar√®me doit commencer √† 0"
      }
    ],
  
    "scoring": {
      "total_points": 100,
      "seuil_reussite": 70,
      "seuil_maitrise": 90
    },
  
    "feedback_manager": {
      "succes": "Excellent ! Tu ma√Ætrises RECHERCHEV approch√©e. Fini les SI imbriqu√©s pour les bar√®mes ! Cette technique marche pour les imp√¥ts, commissions, remises... üéØ",
      "partiel": "Tu as compris le principe. V√©rifie que ta table est tri√©e croissant et que tu utilises bien VRAI.",
      "echec": "RECHERCHEV approch√©e trouve la tranche automatiquement. Cl√© : table tri√©e + VRAI en 4√®me argument."
    },
  
    "socrate_message": {
      "intro": "RECHERCHEV approch√©e, c'est magique pour les bar√®mes ! ü™Ñ Plus besoin de 10 SI imbriqu√©s pour trouver une tranche.",
      "conclusion": "Tu connais maintenant les deux modes de RECHERCHEV : exact (FAUX) pour les codes, approch√© (VRAI) pour les tranches. Combo puissant ! üí™"
    },
  
    "metadata": {
      "version": "1.0",
      "created_at": "2026-01-21",
      "tags": ["RECHERCHEV", "approch√©e", "bar√®me", "tranches", "paie", "interm√©diaire"],
      "prerequis": ["RECHERCHEV exacte"],
      "ouvre_vers": ["INDEX+EQUIV", "Bar√®mes complexes"]
    }
  }