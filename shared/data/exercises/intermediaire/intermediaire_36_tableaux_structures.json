{
    "id": "intermediaire_36_tableaux_structures",
    "titre": "Tableaux Structur√©s : Organiser ses Donn√©es Intelligemment",
    "niveau": "intermediaire",
    "duree_estimee": "18 min",
    "competences": ["Tableaux structur√©s", "R√©f√©rences structur√©es", "Ctrl+T"],
    "competence_ids": [27, 56],
  
    "contexte": {
      "situation": "Tu es gestionnaire de stock chez TechStore. Tes coll√®gues ajoutent des lignes de donn√©es tous les jours, mais les formules ne se mettent pas √† jour, les filtres sautent, le formatage est incoh√©rent... La solution : convertir en tableau structur√©. Excel g√®re tout automatiquement !",
      "manager": {
        "nom": "Philippe Durand",
        "poste": "Responsable Logistique",
        "personnalite": "Pragmatique, il veut que √ßa fonctionne sans maintenance.",
        "demande": "Chaque fois qu'on ajoute un produit, il faut refaire les formules, les filtres, le formatage... C'est pas automatique dans Excel ? Je suis s√ªr qu'il y a un truc."
      },
      "enjeux": "Fiabilit√© des donn√©es et gain de temps.",
      "deadline": "Optimisation continue"
    },
  
    "objectifs": [
      "Convertir une plage en tableau structur√© (Ctrl+T)",
      "Comprendre les avantages des tableaux structur√©s",
      "Utiliser les r√©f√©rences structur√©es dans les formules",
      "Ajouter des colonnes calcul√©es qui s'√©tendent automatiquement"
    ],
  
    "consignes": [
      "Ouvre le fichier avec la liste des produits",
      "Convertis la plage en tableau structur√©",
      "Ajoute une colonne calcul√©e (Valeur Stock)",
      "Utilise les r√©f√©rences structur√©es pour les totaux"
    ],
  
    "donnees": {
      "feuille": "Stock",
      "headers": ["Ref", "Produit", "Cat√©gorie", "Prix_Unitaire", "Quantit√©"],
      "rows": [
        ["P001", "iPhone 15", "Smartphones", 999, 25],
        ["P002", "Samsung S24", "Smartphones", 899, 30],
        ["P003", "MacBook Pro", "Ordinateurs", 2499, 12],
        ["P004", "Dell XPS 15", "Ordinateurs", 1799, 18],
        ["P005", "iPad Pro", "Tablettes", 1199, 22],
        ["P006", "Galaxy Tab S9", "Tablettes", 849, 28],
        ["P007", "AirPods Pro", "Accessoires", 279, 45],
        ["P008", "Galaxy Buds", "Accessoires", 179, 52]
      ],
      "position": "A1:E9"
    },
  
    "etapes": [
      {
        "phase": "A. Convertir en tableau structur√©",
        "methode_1": "S√©lectionne une cellule > Ctrl+T > OK",
        "methode_2": "Insertion > Tableau",
        "verification": "Coche 'Mon tableau comporte des en-t√™tes'",
        "resultat": "Le tableau a un style, des filtres, et un nom (Table1)"
      },
      {
        "phase": "B. Avantages imm√©diats",
        "avantages": [
          "Filtres automatiques sur chaque colonne",
          "Mise en forme altern√©e (lignes color√©es)",
          "Les formules s'√©tendent automatiquement",
          "Les nouvelles lignes h√©ritent du formatage",
          "R√©f√©rencement par nom au lieu de A1:E9"
        ]
      },
      {
        "phase": "C. Renommer le tableau",
        "acces": "Clic dans le tableau > Cr√©ation de tableau > Nom du tableau",
        "exemple": "Renomme en 'Stock' au lieu de 'Table1'",
        "avantage": "Formules plus lisibles : Stock[Prix] au lieu de C2:C100"
      },
      {
        "phase": "D. Ajouter une colonne calcul√©e",
        "etapes": [
          "Tape un en-t√™te dans la colonne suivante (F1: 'Valeur_Stock')",
          "Dans F2, tape : =[@Prix_Unitaire]*[@Quantit√©]",
          "La formule se copie automatiquement sur toutes les lignes !"
        ],
        "note": "[@NomColonne] r√©f√©rence la valeur de la m√™me ligne"
      },
      {
        "phase": "E. R√©f√©rences structur√©es",
        "syntaxes": [
          "Stock[Prix_Unitaire] ‚Üí toute la colonne Prix",
          "[@Prix_Unitaire] ‚Üí valeur de la ligne actuelle",
          "Stock[[#Totaux];[Valeur_Stock]] ‚Üí total de la colonne",
          "Stock[#En-t√™tes] ‚Üí les en-t√™tes",
          "Stock[#Donn√©es] ‚Üí uniquement les donn√©es (sans en-t√™tes)"
        ]
      },
      {
        "phase": "F. Ligne des totaux",
        "activation": "Cr√©ation de tableau > Cocher 'Ligne des totaux'",
        "personnalisation": "Clic sur la cellule total > choisir Somme, Moyenne, Nb...",
        "avantage": "Les totaux ignorent les lignes filtr√©es"
      }
    ],
  
    "checkpoints": [
      {
        "id": "cp_1_tableau_cree",
        "type": "tableau_structure",
        "description": "Plage convertie en tableau structur√©",
        "competence_id": 27,
        "expected_is_table": true,
        "points": 15,
        "indices": [
          "S√©lectionne une cellule dans tes donn√©es",
          "Ctrl+T ou Insertion > Tableau",
          "Les filtres apparaissent automatiquement"
        ]
      },
      {
        "id": "cp_2_tableau_nomme",
        "type": "tableau_nom",
        "description": "Tableau renomm√© 'Stock'",
        "competence_id": 27,
        "expected_name": "Stock",
        "points": 10,
        "indices": [
          "Clic dans le tableau",
          "Onglet Cr√©ation > Nom du tableau",
          "Remplace 'Table1' par 'Stock'"
        ]
      },
      {
        "id": "cp_3_colonne_calculee",
        "cellule": "F2",
        "type": "formule",
        "description": "Colonne Valeur_Stock calcul√©e",
        "competence_id": 56,
        "pattern": ["@", "Prix", "Quantit√©"],
        "points": 20,
        "indices": [
          "En F1, tape 'Valeur_Stock'",
          "En F2 : =[@Prix_Unitaire]*[@Quantit√©]",
          "La formule se propage automatiquement"
        ]
      },
      {
        "id": "cp_4_valeur_iphone",
        "cellule": "F2",
        "type": "valeur",
        "description": "Valeur stock iPhone (999√ó25)",
        "competence_id": 56,
        "expected_value": 24975,
        "points": 10,
        "indices": [
          "999 √ó 25 = 24975",
          "Premi√®re ligne de donn√©es",
          "V√©rifie ta formule"
        ]
      },
      {
        "id": "cp_5_reference_structuree",
        "cellule": "H2",
        "type": "formule",
        "description": "Somme avec r√©f√©rence structur√©e",
        "competence_id": 56,
        "pattern": ["SOMME", "Stock", "Valeur_Stock"],
        "points": 20,
        "indices": [
          "=SOMME(Stock[Valeur_Stock])",
          "R√©f√©rence toute la colonne par son nom",
          "Plus lisible que =SOMME(F2:F9)"
        ]
      },
      {
        "id": "cp_6_ligne_totaux",
        "type": "tableau_totaux",
        "description": "Ligne des totaux activ√©e",
        "competence_id": 27,
        "expected_has_totals": true,
        "points": 15,
        "indices": [
          "Cr√©ation de tableau > Ligne des totaux",
          "Une ligne appara√Æt en bas du tableau",
          "Clic pour choisir le type de calcul"
        ]
      },
      {
        "id": "cp_7_total_valeur",
        "type": "valeur",
        "description": "Total de la colonne Valeur_Stock",
        "competence_id": 27,
        "expected_value": 164174,
        "points": 10,
        "indices": [
          "Somme de tous les F",
          "24975+26970+29988+32382+26378+23772+12555+9308",
          "= 164174 (ou proche si donn√©es diff√©rentes)"
        ]
      }
    ],
  
    "references_structurees_recap": {
      "colonne_entiere": "NomTable[NomColonne]",
      "ligne_actuelle": "[@NomColonne]",
      "plusieurs_colonnes": "NomTable[[Col1]:[Col3]]",
      "donnees_seules": "NomTable[#Donn√©es]",
      "entetes": "NomTable[#En-t√™tes]",
      "totaux": "NomTable[#Totaux]",
      "tout": "NomTable[#Tout]"
    },
  
    "avantages_vs_plage": [
      "Les formules s'√©tendent automatiquement aux nouvelles lignes",
      "Les graphiques li√©s s'actualisent",
      "Les r√©f√©rences structur√©es sont plus lisibles",
      "Le formatage est coh√©rent",
      "Les filtres sont toujours disponibles",
      "Les TCD se mettent √† jour facilement"
    ],
  
    "scoring": {
      "total_points": 100,
      "seuil_reussite": 70,
      "seuil_maitrise": 90
    },
  
    "feedback_manager": {
      "succes": "Parfait ! Tu ma√Ætrises les tableaux structur√©s. Tes donn√©es sont maintenant organis√©es de fa√ßon professionnelle et auto-extensible ! üìã",
      "partiel": "Bon travail ! Ctrl+T est ton ami. Les r√©f√©rences [@Colonne] rendent les formules super lisibles.",
      "echec": "Les tableaux structur√©s simplifient tout. Ctrl+T pour convertir, et Excel g√®re le reste automatiquement."
    },
  
    "socrate_message": {
      "intro": "Les tableaux structur√©s, c'est l'organisation Pro d'Excel ! üìä Fini les plages qui se d√©calent et les formules √† refaire.",
      "conclusion": "Tu connais maintenant le secret des pros : tout mettre en tableau structur√©. Auto-extension, r√©f√©rences lisibles, formatage automatique. La base de tout fichier Excel s√©rieux ! üíº"
    },
  
    "metadata": {
      "version": "1.0",
      "created_at": "2026-01-21",
      "tags": ["tableaux structur√©s", "Ctrl+T", "r√©f√©rences structur√©es", "organisation", "interm√©diaire"],
      "prerequis": ["Formules de base", "Filtres"],
      "ouvre_vers": ["Power Query", "TCD", "Mod√®les de donn√©es"]
    }
  }