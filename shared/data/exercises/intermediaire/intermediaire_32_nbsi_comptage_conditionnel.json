{
  "id": "intermediaire_32_nbsi_comptage_conditionnel",
  "titre": "NB.SI : Compter avec des CritÃ¨res",
  "niveau": "intermediaire",
  "duree_estimee": "18 min",
  "competences": [
    "NB.SI",
    "Comptage conditionnel",
    "CritÃ¨res"
  ],
  "competence_ids": [
    11
  ],
  "contexte": {
    "situation": "Tu es assistant(e) de direction chez EventConnect, une agence Ã©vÃ©nementielle. Le directeur te demande des statistiques rapides sur les Ã©vÃ©nements de l'annÃ©e : combien d'Ã©vÃ©nements par type, par statut, par ville... Tu dois maÃ®triser NB.SI pour rÃ©pondre en quelques secondes.",
    "manager": {
      "nom": "Olivier Blanchard",
      "poste": "Directeur GÃ©nÃ©ral",
      "personnalite": "Impatient, il veut des chiffres instantanÃ©ment pendant les rÃ©unions.",
      "demande": "Combien de mariages cette annÃ©e ? Combien d'Ã©vÃ©nements annulÃ©s ? Combien Ã  Paris ? Je veux pouvoir rÃ©pondre Ã  ces questions en 2 secondes, pas en fouillant dans le tableau pendant 5 minutes."
    },
    "enjeux": "CrÃ©dibilitÃ© en rÃ©union client et en CODIR.",
    "deadline": "Avant la rÃ©union de 14h"
  },
  "objectifs": [
    "MaÃ®triser la syntaxe de NB.SI",
    "Compter avec des critÃ¨res texte (exact, partiel)",
    "Compter avec des critÃ¨res numÃ©riques (>, <, >=, <>)",
    "Utiliser des rÃ©fÃ©rences de cellules comme critÃ¨res",
    "Comprendre la diffÃ©rence NB.SI vs NB.SI.ENS"
  ],
  "consignes": [
    "Ouvre le fichier avec la liste des Ã©vÃ©nements 2025",
    "Utilise NB.SI pour compter les Ã©vÃ©nements par type",
    "Compte les Ã©vÃ©nements par statut et par ville",
    "CrÃ©e un mini-tableau de bord avec les statistiques clÃ©s"
  ],
  "donnees": {
    "feuille": "Evenements",
    "headers": [
      "ID",
      "Nom_Evenement",
      "Type",
      "Ville",
      "Date",
      "Budget",
      "Statut"
    ],
    "rows": [
      [
        "EV001",
        "Mariage Dupont-Martin",
        "Mariage",
        "Paris",
        "15/03/2025",
        25000,
        "ConfirmÃ©"
      ],
      [
        "EV002",
        "SÃ©minaire TechCorp",
        "SÃ©minaire",
        "Lyon",
        "22/04/2025",
        15000,
        "ConfirmÃ©"
      ],
      [
        "EV003",
        "Anniversaire 50 ans",
        "Anniversaire",
        "Paris",
        "10/05/2025",
        8000,
        "En attente"
      ],
      [
        "EV004",
        "Mariage Laurent-Petit",
        "Mariage",
        "Bordeaux",
        "28/06/2025",
        32000,
        "ConfirmÃ©"
      ],
      [
        "EV005",
        "ConfÃ©rence IA 2025",
        "ConfÃ©rence",
        "Paris",
        "15/09/2025",
        45000,
        "ConfirmÃ©"
      ],
      [
        "EV006",
        "Gala de charitÃ©",
        "Gala",
        "Lyon",
        "20/10/2025",
        60000,
        "En attente"
      ],
      [
        "EV007",
        "SÃ©minaire StartupNation",
        "SÃ©minaire",
        "Paris",
        "05/11/2025",
        12000,
        "AnnulÃ©"
      ],
      [
        "EV008",
        "Mariage Chen-Dubois",
        "Mariage",
        "Paris",
        "12/12/2025",
        28000,
        "ConfirmÃ©"
      ],
      [
        "EV009",
        "Anniversaire entreprise",
        "Anniversaire",
        "Marseille",
        "18/01/2025",
        18000,
        "ConfirmÃ©"
      ],
      [
        "EV010",
        "ConfÃ©rence DevOps",
        "ConfÃ©rence",
        "Lyon",
        "25/02/2025",
        35000,
        "AnnulÃ©"
      ],
      [
        "EV011",
        "Mariage Moreau-Leroy",
        "Mariage",
        "Lille",
        "08/07/2025",
        22000,
        "En attente"
      ],
      [
        "EV012",
        "SÃ©minaire RH Avenir",
        "SÃ©minaire",
        "Paris",
        "30/08/2025",
        9500,
        "ConfirmÃ©"
      ]
    ],
    "position": "A1:G13"
  },
  "etapes": [
    {
      "phase": "A. Syntaxe de base NB.SI",
      "syntaxe": "=NB.SI(plage; critÃ¨re)",
      "arguments": [
        "plage : la colonne oÃ¹ chercher",
        "critÃ¨re : ce qu'on cherche (texte, nombre, ou condition)"
      ],
      "exemple": "=NB.SI(C2:C13;\"Mariage\") â†’ compte les mariages"
    },
    {
      "phase": "B. CritÃ¨res texte",
      "types": [
        "Exact : \"Mariage\" â†’ compte exactement 'Mariage'",
        "Partiel avec * : \"*Paris*\" â†’ contient 'Paris'",
        "Commence par : \"Mar*\" â†’ commence par 'Mar'",
        "Finit par : \"*2025\" â†’ finit par '2025'"
      ]
    },
    {
      "phase": "C. CritÃ¨res numÃ©riques",
      "types": [
        "Ã‰gal : 25000 ou \"=25000\"",
        "SupÃ©rieur : \">20000\"",
        "InfÃ©rieur ou Ã©gal : \"<=15000\"",
        "DiffÃ©rent : \"<>0\" ou \"<>AnnulÃ©\""
      ],
      "attention": "Les opÃ©rateurs doivent Ãªtre entre guillemets : \">20000\" pas >20000"
    },
    {
      "phase": "D. CritÃ¨re dynamique (rÃ©fÃ©rence cellule)",
      "consignes": [
        "Si le critÃ¨re est dans une cellule (ex: J2 contient 'Paris')",
        "=NB.SI(D2:D13;J2)",
        "Pour combiner avec opÃ©rateur : \">\"&J2 ou \"<=\"&K2"
      ]
    }
  ],
  "checkpoints": [
    {
      "id": "cp_1_nb_mariages",
      "cellule": "J3",
      "type": "valeur",
      "description": "Nombre de mariages",
      "competence_id": 11,
      "expected_value": 4,
      "points": 15,
      "indices": [
        "Compte dans la colonne Type (C)",
        "CritÃ¨re : \"Mariage\"",
        "=NB.SI(C2:C13;\"Mariage\")"
      ]
    },
    {
      "id": "cp_2_formule_nbsi",
      "cellule": "J3",
      "type": "formule",
      "description": "Formule NB.SI correcte",
      "competence_id": 11,
      "fonction": "NB.SI",
      "pattern": [
        "NB.SI",
        "Mariage"
      ],
      "points": 10,
      "indices": [
        "La formule doit utiliser NB.SI",
        "Le critÃ¨re doit Ãªtre entre guillemets",
        "=NB.SI(plage;\"Mariage\")"
      ],
      "computation": {
        "type": "countif",
        "column": "auto",
        "criteria": "auto"
      }
    },
    {
      "id": "cp_3_nb_paris",
      "cellule": "J4",
      "type": "valeur",
      "description": "Nombre d'Ã©vÃ©nements Ã  Paris",
      "competence_id": 11,
      "expected_value": 5,
      "points": 15,
      "indices": [
        "Compte dans la colonne Ville (D)",
        "=NB.SI(D2:D13;\"Paris\")",
        "5 Ã©vÃ©nements sont Ã  Paris"
      ]
    },
    {
      "id": "cp_4_nb_confirmes",
      "cellule": "J5",
      "type": "valeur",
      "description": "Nombre d'Ã©vÃ©nements confirmÃ©s",
      "competence_id": 11,
      "expected_value": 7,
      "points": 15,
      "indices": [
        "Compte dans la colonne Statut (G)",
        "=NB.SI(G2:G13;\"ConfirmÃ©\")",
        "7 Ã©vÃ©nements sont confirmÃ©s"
      ]
    },
    {
      "id": "cp_5_nb_annules",
      "cellule": "J6",
      "type": "valeur",
      "description": "Nombre d'Ã©vÃ©nements annulÃ©s",
      "competence_id": 11,
      "expected_value": 2,
      "points": 10,
      "indices": [
        "=NB.SI(G2:G13;\"AnnulÃ©\")",
        "2 Ã©vÃ©nements ont Ã©tÃ© annulÃ©s",
        "SÃ©minaire et ConfÃ©rence DevOps"
      ]
    },
    {
      "id": "cp_6_budget_sup_20k",
      "cellule": "J7",
      "type": "valeur",
      "description": "Ã‰vÃ©nements avec budget > 20000â‚¬",
      "competence_id": 11,
      "expected_value": 7,
      "points": 15,
      "indices": [
        "CritÃ¨re numÃ©rique avec opÃ©rateur",
        "L'opÃ©rateur doit Ãªtre entre guillemets",
        "=NB.SI(F2:F13;\">20000\")"
      ]
    },
    {
      "id": "cp_7_seminaires",
      "cellule": "J8",
      "type": "valeur",
      "description": "Nombre de sÃ©minaires",
      "competence_id": 11,
      "expected_value": 3,
      "points": 10,
      "indices": [
        "=NB.SI(C2:C13;\"SÃ©minaire\")",
        "3 sÃ©minaires dans la liste",
        "TechCorp, StartupNation, RH Avenir"
      ]
    },
    {
      "id": "cp_8_critere_dynamique",
      "cellule": "J10",
      "type": "formule",
      "description": "NB.SI avec critÃ¨re dynamique",
      "competence_id": 11,
      "fonction": "NB.SI",
      "pattern": [
        "NB.SI",
        "I10"
      ],
      "points": 10,
      "indices": [
        "Le critÃ¨re doit rÃ©fÃ©rencer une cellule",
        "Si I10 contient 'Lyon', compte les Lyon",
        "=NB.SI(D2:D13;I10)"
      ],
      "computation": {
        "type": "countif",
        "column": "auto",
        "criteria": "auto"
      }
    }
  ],
  "difference_nbsi_nbsiens": {
    "nbsi": {
      "usage": "UN seul critÃ¨re",
      "syntaxe": "=NB.SI(plage;critÃ¨re)",
      "exemple": "Combien de mariages ?"
    },
    "nbsiens": {
      "usage": "PLUSIEURS critÃ¨res (ET logique)",
      "syntaxe": "=NB.SI.ENS(plage1;crit1;plage2;crit2;...)",
      "exemple": "Combien de mariages Ã€ PARIS ?"
    }
  },
  "erreurs_frequentes": [
    {
      "erreur": "Oublier les guillemets autour du critÃ¨re texte",
      "incorrect": "=NB.SI(C:C;Mariage)",
      "correct": "=NB.SI(C:C;\"Mariage\")"
    },
    {
      "erreur": "Oublier les guillemets autour de l'opÃ©rateur",
      "incorrect": "=NB.SI(F:F;>20000)",
      "correct": "=NB.SI(F:F;\">20000\")"
    },
    {
      "erreur": "Utiliser NB.SI pour plusieurs critÃ¨res",
      "probleme": "=NB.SI(C:C;\"Mariage\";D:D;\"Paris\") â†’ ERREUR",
      "solution": "Utilise NB.SI.ENS pour plusieurs critÃ¨res"
    }
  ],
  "scoring": {
    "total_points": 100,
    "seuil_reussite": 70,
    "seuil_maitrise": 90
  },
  "feedback_manager": {
    "succes": "Parfait ! Tu maÃ®trises NB.SI. Tu peux maintenant compter n'importe quoi en quelques secondes. Le directeur sera impressionnÃ© ! ğŸ“Š",
    "partiel": "Bon dÃ©but ! N'oublie pas : les critÃ¨res texte ET les opÃ©rateurs numÃ©riques doivent Ãªtre entre guillemets.",
    "echec": "NB.SI est simple : =NB.SI(oÃ¹_chercher;\"quoi_chercher\"). Les guillemets sont essentiels !"
  },
  "socrate_message": {
    "intro": "NB.SI, c'est la fonction de comptage intelligent ! ğŸ”¢ Combien de X ? Combien de Y ? RÃ©ponse instantanÃ©e.",
    "conclusion": "Tu sais maintenant compter avec des critÃ¨res. NB.SI pour un critÃ¨re, NB.SI.ENS pour plusieurs. Simple et puissant ! ğŸ¯"
  },
  "metadata": {
    "version": "1.0",
    "created_at": "2026-01-21",
    "tags": [
      "NB.SI",
      "COUNTIF",
      "comptage",
      "critÃ¨res",
      "intermÃ©diaire"
    ],
    "prerequis": [
      "Formules de base"
    ],
    "ouvre_vers": [
      "NB.SI.ENS",
      "SOMME.SI",
      "SOMMEPROD"
    ]
  }
}