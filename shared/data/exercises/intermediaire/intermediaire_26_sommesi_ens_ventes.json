{
    "id": "intermediaire_26_sommesi_ens_ventes",
    "titre": "SOMME.SI.ENS : Analyse des Ventes Multi-Crit√®res",
    "niveau": "intermediaire",
    "duree_estimee": "22 min",
    "competences": ["SOMME.SI.ENS", "Somme multi-crit√®res"],
    "competence_ids": [14],
  
    "contexte": {
      "situation": "Tu es contr√¥leur de gestion chez AutoPlus, un r√©seau de concessions automobiles. Le directeur financier veut analyser les ventes par r√©gion, par vendeur, par type de v√©hicule... Tu dois cr√©er un tableau de bord avec des sommes conditionnelles crois√©es.",
      "manager": {
        "nom": "Fran√ßois Legrand",
        "poste": "Directeur Financier",
        "personnalite": "Cart√©sien, il veut des analyses pr√©cises pour piloter les performances.",
        "demande": "Je veux savoir exactement combien on a vendu par r√©gion et par type de v√©hicule. Et aussi par vendeur et par trimestre. SOMME.SI ne suffit plus, j'ai besoin de croiser les crit√®res."
      },
      "enjeux": "Les bonus des vendeurs d√©pendent de ces chiffres. Pas droit √† l'erreur.",
      "deadline": "Lundi pour la r√©union commerciale"
    },
  
    "objectifs": [
      "Comprendre SOMME.SI.ENS : somme avec plusieurs crit√®res",
      "Ma√Ætriser la syntaxe (plage_somme en premier !)",
      "Croiser r√©gion + type, vendeur + p√©riode, etc.",
      "Utiliser des crit√®res avec op√©rateurs et r√©f√©rences"
    ],
  
    "consignes": [
      "Ouvre le fichier des ventes trimestrielles",
      "Calcule le CA par combinaison de crit√®res",
      "Cr√©e un tableau crois√© R√©gion √ó Type de v√©hicule",
      "Analyse les performances par vendeur et par trimestre"
    ],
  
    "donnees": {
      "feuille": "Ventes",
      "headers": ["Date", "Vendeur", "R√©gion", "Type", "Mod√®le", "Prix", "Marge"],
      "rows": [
        ["15/01/2024", "Dupont", "Nord", "SUV", "X-Trail", 35000, 3500],
        ["22/01/2024", "Martin", "Sud", "Berline", "M√©gane", 28000, 2800],
        ["05/02/2024", "Dupont", "Nord", "Citadine", "Clio", 18000, 1800],
        ["18/02/2024", "Bernard", "Est", "SUV", "Captur", 25000, 2500],
        ["03/03/2024", "Martin", "Sud", "SUV", "Kadjar", 32000, 3200],
        ["20/03/2024", "Dupont", "Nord", "Berline", "Talisman", 38000, 3800],
        ["10/04/2024", "Bernard", "Est", "Citadine", "Twingo", 15000, 1500],
        ["25/04/2024", "Leroy", "Ouest", "SUV", "Arkana", 36000, 3600],
        ["08/05/2024", "Martin", "Sud", "Citadine", "Zoe", 22000, 2200],
        ["22/05/2024", "Dupont", "Nord", "SUV", "Koleos", 42000, 4200],
        ["05/06/2024", "Leroy", "Ouest", "Berline", "Talisman", 38000, 3800],
        ["18/06/2024", "Bernard", "Est", "SUV", "X-Trail", 35000, 3500],
        ["02/07/2024", "Martin", "Sud", "SUV", "Captur", 25000, 2500],
        ["15/07/2024", "Dupont", "Nord", "Citadine", "Clio", 18000, 1800],
        ["28/07/2024", "Leroy", "Ouest", "SUV", "Kadjar", 32000, 3200]
      ],
      "resultats_attendus": {
        "ca_nord_suv": 77000,
        "ca_sud_total": 107000,
        "ca_dupont_t1": 91000,
        "marge_est_suv": 6000,
        "ca_prix_sup_30k": 288000
      }
    },
  
    "etapes": [
      {
        "phase": "A. Syntaxe SOMME.SI.ENS",
        "explications": [
          "ATTENTION : l'ordre est diff√©rent de NB.SI.ENS !",
          "=SOMME.SI.ENS(plage_somme; plage_crit√®re1; crit√®re1; plage_crit√®re2; crit√®re2; ...)",
          "La plage √† additionner vient EN PREMIER"
        ],
        "comparaison": {
          "nb_si_ens": "=NB.SI.ENS(plage1;crit√®re1;plage2;crit√®re2)",
          "somme_si_ens": "=SOMME.SI.ENS(plage_somme;plage1;crit√®re1;plage2;crit√®re2)"
        }
      },
      {
        "phase": "B. Somme avec 2 crit√®res",
        "consignes": [
          "CA des SUV vendus dans le Nord ?",
          "Plage somme : colonne Prix (F)",
          "Crit√®re 1 : R√©gion = Nord",
          "Crit√®re 2 : Type = SUV",
          "=SOMME.SI.ENS(F2:F16;C2:C16;\"Nord\";D2:D16;\"SUV\")"
        ]
      },
      {
        "phase": "C. Somme avec crit√®re num√©rique",
        "consignes": [
          "CA des ventes > 30000‚Ç¨ ?",
          "=SOMME.SI.ENS(F2:F16;F2:F16;\">30000\")",
          "Ici la plage_somme et la plage_crit√®re sont les m√™mes !"
        ]
      },
      {
        "phase": "D. Analyse par vendeur et p√©riode",
        "consignes": [
          "CA de Dupont au T1 (janvier-mars) ?",
          "Crit√®re 1 : Vendeur = Dupont",
          "Crit√®re 2 : Date >= 01/01/2024",
          "Crit√®re 3 : Date <= 31/03/2024",
          "=SOMME.SI.ENS(F:F;B:B;\"Dupont\";A:A;\">=\"&DATE(2024;1;1);A:A;\"<=\"&DATE(2024;3;31))"
        ]
      }
    ],
  
    "checkpoints": [
      {
        "id": "cp_1_ca_nord_suv",
        "cellule": "J2",
        "type": "valeur",
        "description": "CA des SUV vendus dans le Nord",
        "competence_id": 14,
        "expected_value": 77000,
        "points": 20,
        "indices": [
          "Plage somme = Prix (F2:F16)",
          "Crit√®re 1 : R√©gion = \"Nord\"",
          "Crit√®re 2 : Type = \"SUV\"",
          "=SOMME.SI.ENS(F2:F16;C2:C16;\"Nord\";D2:D16;\"SUV\")"
        ]
      },
      {
        "id": "cp_2_ca_sud_total",
        "cellule": "J3",
        "type": "valeur",
        "description": "CA total r√©gion Sud",
        "competence_id": 14,
        "expected_value": 107000,
        "points": 15,
        "indices": [
          "Un seul crit√®re suffit ici",
          "=SOMME.SI.ENS(F2:F16;C2:C16;\"Sud\")",
          "Ou =SOMME.SI(C2:C16;\"Sud\";F2:F16)"
        ]
      },
      {
        "id": "cp_3_ca_est_citadine",
        "cellule": "J4",
        "type": "valeur",
        "description": "CA des citadines vendues dans l'Est",
        "competence_id": 14,
        "expected_value": 15000,
        "points": 15,
        "indices": [
          "R√©gion = \"Est\" ET Type = \"Citadine\"",
          "=SOMME.SI.ENS(F2:F16;C2:C16;\"Est\";D2:D16;\"Citadine\")",
          "Une seule vente : Twingo √† 15000‚Ç¨"
        ]
      },
      {
        "id": "cp_4_marge_ouest",
        "cellule": "J5",
        "type": "valeur",
        "description": "Marge totale r√©gion Ouest",
        "competence_id": 14,
        "expected_value": 10600,
        "points": 15,
        "indices": [
          "Attention : somme sur la MARGE (colonne G), pas le prix",
          "=SOMME.SI.ENS(G2:G16;C2:C16;\"Ouest\")",
          "3 ventes Leroy : 3600 + 3800 + 3200"
        ]
      },
      {
        "id": "cp_5_ca_dupont",
        "cellule": "J6",
        "type": "valeur",
        "description": "CA total de Dupont",
        "competence_id": 14,
        "expected_value": 151000,
        "points": 10,
        "indices": [
          "Crit√®re : Vendeur = \"Dupont\"",
          "=SOMME.SI.ENS(F2:F16;B2:B16;\"Dupont\")",
          "5 ventes : 35000+18000+38000+42000+18000"
        ]
      },
      {
        "id": "cp_6_ca_sup_30k",
        "cellule": "J7",
        "type": "valeur",
        "description": "CA des ventes sup√©rieures √† 30000‚Ç¨",
        "competence_id": 14,
        "expected_value": 288000,
        "points": 15,
        "indices": [
          "Crit√®re num√©rique : \">30000\"",
          "La plage crit√®re = plage somme",
          "=SOMME.SI.ENS(F2:F16;F2:F16;\">30000\")"
        ]
      },
      {
        "id": "cp_7_marge_suv_nord_est",
        "cellule": "J8",
        "type": "valeur",
        "description": "Marge des SUV vendus dans le Nord OU l'Est",
        "competence_id": 14,
        "expected_value": 13700,
        "points": 10,
        "indices": [
          "Attention : OU n√©cessite 2 formules",
          "=SOMME.SI.ENS(G:G;C:C;\"Nord\";D:D;\"SUV\")+SOMME.SI.ENS(G:G;C:C;\"Est\";D:D;\"SUV\")",
          "Nord SUV : 7700‚Ç¨ + Est SUV : 6000‚Ç¨"
        ]
      }
    ],
  
    "differences_syntaxe": {
      "somme_si": "=SOMME.SI(plage_crit√®re; crit√®re; plage_somme)",
      "somme_si_ens": "=SOMME.SI.ENS(plage_somme; plage_crit√®re1; crit√®re1; plage_crit√®re2; crit√®re2)",
      "attention": "L'ordre des arguments est INVERS√â entre SOMME.SI et SOMME.SI.ENS !"
    },
  
    "erreurs_frequentes": [
      {
        "erreur": "Plage somme √† la mauvaise position",
        "exemple": "=SOMME.SI.ENS(C:C;\"Nord\";F:F)",
        "correction": "=SOMME.SI.ENS(F:F;C:C;\"Nord\") - la plage somme vient EN PREMIER"
      },
      {
        "erreur": "Confondre avec SOMME.SI",
        "exemple": "SOMME.SI a l'ordre : plage_crit√®re, crit√®re, plage_somme",
        "correction": "SOMME.SI.ENS a l'ordre : plage_somme, puis paires plage/crit√®re"
      },
      {
        "erreur": "Crit√®re OU au lieu de ET",
        "exemple": "SOMME.SI.ENS ne fait que des ET",
        "correction": "Pour un OU, additionne plusieurs SOMME.SI.ENS"
      }
    ],
  
    "scoring": {
      "total_points": 100,
      "seuil_reussite": 70,
      "seuil_maitrise": 90
    },
  
    "feedback_manager": {
      "succes": "Excellent ! Tu ma√Ætrises SOMME.SI.ENS. Tu peux maintenant cr√©er des tableaux de bord analytiques puissants ! üìà",
      "partiel": "Attention √† l'ordre des arguments : plage_somme EN PREMIER, puis les paires plage/crit√®re.",
      "echec": "SOMME.SI.ENS est puissant mais sa syntaxe est pi√©geuse. Retiens : somme d'abord, crit√®res ensuite."
    },
  
    "socrate_message": {
      "intro": "SOMME.SI.ENS combine la puissance de SOMME.SI avec celle des crit√®res multiples. Attention √† l'ordre des arguments ! üéØ",
      "conclusion": "Tu sais maintenant faire des sommes conditionnelles crois√©es. C'est la base des tableaux de bord Excel professionnels ! üíº"
    },
  
    "metadata": {
      "version": "1.0",
      "created_at": "2026-01-21",
      "tags": ["SOMME.SI.ENS", "multi-crit√®res", "somme conditionnelle", "ventes", "analyse", "interm√©diaire"],
      "prerequis": ["SOMME.SI", "NB.SI.ENS"],
      "ouvre_vers": ["MOYENNE.SI.ENS", "Tableaux de bord"]
    }
  }