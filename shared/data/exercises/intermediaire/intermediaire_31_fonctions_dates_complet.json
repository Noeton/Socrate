{
    "id": "intermediaire_31_fonctions_dates_complet",
    "titre": "Ma√Ætriser les Fonctions Date : DATEDIF, ANNEE, MOIS et Plus",
    "niveau": "intermediaire",
    "duree_estimee": "25 min",
    "competences": ["Fonctions date", "DATEDIF", "ANNEE", "MOIS", "JOUR", "FIN.MOIS"],
    "competence_ids": [21],
  
    "contexte": {
      "situation": "Tu es assistant(e) RH chez ConseilPlus, un cabinet de conseil. Tu dois pr√©parer plusieurs analyses bas√©es sur les dates : anciennet√© des consultants, dates d'anniversaire de contrat, √©ch√©ances de p√©riodes d'essai, calcul d'√¢ge pour les statistiques.",
      "manager": {
        "nom": "Am√©lie Rousseau",
        "poste": "DRH",
        "personnalite": "Orient√©e donn√©es, elle veut des tableaux de bord RH pr√©cis.",
        "demande": "J'ai besoin de calculer l'anciennet√© exacte en ann√©es/mois/jours, les dates de fin de p√©riode d'essai, et l'√¢ge de chaque consultant. Excel sait faire tout √ßa automatiquement, non ?"
      },
      "enjeux": "Rapports sociaux obligatoires + planning des entretiens annuels.",
      "deadline": "Pour le bilan social du mois"
    },
  
    "objectifs": [
      "Calculer des dur√©es entre deux dates avec DATEDIF",
      "Extraire ann√©e, mois, jour d'une date",
      "Calculer des √©ch√©ances avec FIN.MOIS et MOIS.DECALER",
      "Utiliser AUJOURDHUI() pour des calculs dynamiques",
      "Formater et manipuler les dates"
    ],
  
    "consignes": [
      "Ouvre le fichier avec la liste des consultants",
      "Calcule l'anciennet√© en ann√©es, mois et jours",
      "Calcule l'√¢ge de chaque consultant",
      "D√©termine la date de fin de p√©riode d'essai (embauche + 3 mois)",
      "Identifie le mois et l'ann√©e d'embauche pour les statistiques"
    ],
  
    "donnees": {
      "feuille": "Consultants",
      "headers": ["ID", "Nom", "Date naissance", "Date embauche", "Anciennet√© (ans)", "Anciennet√© (mois)", "√Çge", "Fin p√©riode essai", "Mois embauche", "Ann√©e embauche"],
      "rows": [
        ["C001", "Martin Sophie", "15/03/1985", "01/09/2020", null, null, null, null, null, null],
        ["C002", "Dubois Thomas", "22/07/1990", "15/01/2019", null, null, null, null, null, null],
        ["C003", "Bernard Claire", "08/11/1988", "01/06/2023", null, null, null, null, null, null],
        ["C004", "Petit Lucas", "30/04/1992", "20/03/2021", null, null, null, null, null, null],
        ["C005", "Robert Emma", "12/12/1987", "05/11/2018", null, null, null, null, null, null],
        ["C006", "Durand Marc", "25/01/1995", "01/02/2024", null, null, null, null, null, null],
        ["C007", "Leroy Julie", "18/06/1983", "10/07/2015", null, null, null, null, null, null],
        ["C008", "Moreau Antoine", "03/09/1991", "01/04/2022", null, null, null, null, null, null]
      ]
    },
  
    "etapes": [
      {
        "phase": "A. DATEDIF - Calculer des dur√©es",
        "explications": [
          "DATEDIF(date_d√©but; date_fin; unit√©) calcule la diff√©rence entre 2 dates",
          "Unit√©s : 'Y' = ann√©es, 'M' = mois, 'D' = jours",
          "Unit√©s combin√©es : 'YM' = mois restants apr√®s ann√©es, 'MD' = jours restants"
        ],
        "syntaxe": "=DATEDIF(D2; AUJOURDHUI(); \"Y\") ‚Üí anciennet√© en ann√©es compl√®tes"
      },
      {
        "phase": "B. Anciennet√© en ann√©es",
        "consignes": [
          "En E2, calcule l'anciennet√© en ann√©es compl√®tes :",
          "=DATEDIF(D2;AUJOURDHUI();\"Y\")",
          "D2 = date d'embauche",
          "AUJOURDHUI() = date du jour",
          "\"Y\" = ann√©es compl√®tes"
        ]
      },
      {
        "phase": "C. Anciennet√© en mois totaux",
        "consignes": [
          "En F2, calcule l'anciennet√© en mois TOTAUX :",
          "=DATEDIF(D2;AUJOURDHUI();\"M\")",
          "\"M\" = nombre total de mois (pas seulement les mois restants)"
        ]
      },
      {
        "phase": "D. Calculer l'√¢ge",
        "consignes": [
          "En G2, calcule l'√¢ge du consultant :",
          "=DATEDIF(C2;AUJOURDHUI();\"Y\")",
          "C2 = date de naissance",
          "M√™me principe que l'anciennet√©"
        ]
      },
      {
        "phase": "E. Date de fin de p√©riode d'essai",
        "consignes": [
          "P√©riode d'essai = 3 mois apr√®s embauche",
          "En H2 : =FIN.MOIS(D2;3)",
          "Ou : =MOIS.DECALER(D2;3;0) si tu veux garder le m√™me jour",
          "Ou simplement : =DATE(ANNEE(D2);MOIS(D2)+3;JOUR(D2))"
        ]
      },
      {
        "phase": "F. Extraire mois et ann√©e",
        "consignes": [
          "En I2 (mois d'embauche) : =MOIS(D2)",
          "En J2 (ann√©e d'embauche) : =ANNEE(D2)",
          "Utile pour les statistiques par p√©riode"
        ]
      }
    ],
  
    "checkpoints": [
      {
        "id": "cp_1_anciennete_annees",
        "cellule": "E2",
        "type": "formule",
        "description": "Anciennet√© en ann√©es avec DATEDIF",
        "competence_id": 21,
        "fonction": "DATEDIF",
        "pattern": ["DATEDIF", "D2", "AUJOURDHUI", "Y"],
        "points": 20,
        "indices": [
          "DATEDIF calcule la diff√©rence entre 2 dates",
          "=DATEDIF(date_d√©but; date_fin; unit√©)",
          "=DATEDIF(D2;AUJOURDHUI();\"Y\")"
        ]
      },
      {
        "id": "cp_2_anciennete_mois",
        "cellule": "F2",
        "type": "formule",
        "description": "Anciennet√© en mois totaux",
        "competence_id": 21,
        "fonction": "DATEDIF",
        "pattern": ["DATEDIF", "D2", "M"],
        "points": 15,
        "indices": [
          "\"M\" = mois totaux",
          "=DATEDIF(D2;AUJOURDHUI();\"M\")",
          "Ex: 4 ans 3 mois = 51 mois"
        ]
      },
      {
        "id": "cp_3_age",
        "cellule": "G2",
        "type": "formule",
        "description": "√Çge calcul√© avec DATEDIF",
        "competence_id": 21,
        "fonction": "DATEDIF",
        "pattern": ["DATEDIF", "C2", "Y"],
        "points": 15,
        "indices": [
          "M√™me principe mais avec date de naissance (C2)",
          "=DATEDIF(C2;AUJOURDHUI();\"Y\")",
          "Martin Sophie n√©e en 1985"
        ]
      },
      {
        "id": "cp_4_fin_essai",
        "cellule": "H2",
        "type": "formule",
        "description": "Date fin p√©riode d'essai (+3 mois)",
        "competence_id": 21,
        "pattern": ["FIN.MOIS", "3"],
        "alternative_patterns": [["MOIS.DECALER"], ["DATE", "MOIS", "+3"]],
        "points": 15,
        "indices": [
          "FIN.MOIS(date; nb_mois) ‚Üí dernier jour du mois cible",
          "=FIN.MOIS(D2;3) pour +3 mois",
          "Ou =DATE(ANNEE(D2);MOIS(D2)+3;JOUR(D2))"
        ]
      },
      {
        "id": "cp_5_mois_embauche",
        "cellule": "I2",
        "type": "formule",
        "description": "Extraction du mois d'embauche",
        "competence_id": 21,
        "fonction": "MOIS",
        "pattern": ["MOIS", "D2"],
        "expected_value": 9,
        "points": 10,
        "indices": [
          "MOIS(date) extrait le num√©ro du mois",
          "=MOIS(D2)",
          "01/09/2020 ‚Üí 9 (septembre)"
        ]
      },
      {
        "id": "cp_6_annee_embauche",
        "cellule": "J2",
        "type": "formule",
        "description": "Extraction de l'ann√©e d'embauche",
        "competence_id": 21,
        "fonction": "ANNEE",
        "pattern": ["ANNEE", "D2"],
        "expected_value": 2020,
        "points": 10,
        "indices": [
          "ANNEE(date) extrait l'ann√©e",
          "=ANNEE(D2)",
          "01/09/2020 ‚Üí 2020"
        ]
      },
      {
        "id": "cp_7_recopie_complete",
        "cellule": "E9",
        "type": "formule",
        "description": "Formules recopi√©es sur toutes les lignes",
        "competence_id": 21,
        "fonction": "DATEDIF",
        "pattern": ["DATEDIF", "D9"],
        "points": 15,
        "indices": [
          "Les formules doivent √™tre recopi√©es jusqu'√† la ligne 9",
          "V√©rifie que les r√©f√©rences s'adaptent (D2‚ÜíD9)",
          "Moreau Antoine doit avoir son anciennet√© calcul√©e"
        ]
      }
    ],
  
    "fonctions_date_recap": [
      {
        "fonction": "AUJOURDHUI()",
        "description": "Date du jour (se met √† jour automatiquement)",
        "exemple": "=AUJOURDHUI() ‚Üí 21/01/2026"
      },
      {
        "fonction": "ANNEE(date)",
        "description": "Extrait l'ann√©e d'une date",
        "exemple": "=ANNEE(\"15/03/2020\") ‚Üí 2020"
      },
      {
        "fonction": "MOIS(date)",
        "description": "Extrait le mois (1-12)",
        "exemple": "=MOIS(\"15/03/2020\") ‚Üí 3"
      },
      {
        "fonction": "JOUR(date)",
        "description": "Extrait le jour (1-31)",
        "exemple": "=JOUR(\"15/03/2020\") ‚Üí 15"
      },
      {
        "fonction": "DATEDIF(d√©but;fin;unit√©)",
        "description": "Calcule la diff√©rence entre 2 dates",
        "unites": ["Y=ann√©es", "M=mois", "D=jours", "YM=mois restants", "MD=jours restants"]
      },
      {
        "fonction": "FIN.MOIS(date;mois)",
        "description": "Dernier jour du mois √† +/- n mois",
        "exemple": "=FIN.MOIS(\"15/01/2024\";2) ‚Üí 31/03/2024"
      },
      {
        "fonction": "DATE(ann√©e;mois;jour)",
        "description": "Cr√©e une date √† partir de composants",
        "exemple": "=DATE(2024;12;25) ‚Üí 25/12/2024"
      },
      {
        "fonction": "JOURSEM(date)",
        "description": "Jour de la semaine (1=dim √† 7=sam)",
        "exemple": "=JOURSEM(\"21/01/2026\") ‚Üí 4 (mercredi)"
      }
    ],
  
    "scoring": {
      "total_points": 100,
      "seuil_reussite": 70,
      "seuil_maitrise": 90
    },
  
    "feedback_manager": {
      "succes": "Excellent ! Tu ma√Ætrises les fonctions date d'Excel. DATEDIF, ANNEE, MOIS, FIN.MOIS... tu peux tout calculer maintenant ! üìÖ",
      "partiel": "Bien jou√© ! V√©rifie les unit√©s de DATEDIF : \"Y\" pour ann√©es, \"M\" pour mois totaux.",
      "echec": "Les dates Excel sont puissantes mais demandent de la pratique. DATEDIF est la cl√© pour les dur√©es."
    },
  
    "socrate_message": {
      "intro": "Les dates dans Excel, c'est un monde ! üìÜ DATEDIF est ta fonction magique pour calculer des dur√©es. √Çge, anciennet√©, √©ch√©ances... tout devient simple.",
      "conclusion": "Tu ma√Ætrises maintenant les dates Excel ! DATEDIF pour les dur√©es, ANNEE/MOIS/JOUR pour extraire, FIN.MOIS pour les √©ch√©ances. Puissant ! üóìÔ∏è"
    },
  
    "metadata": {
      "version": "1.0",
      "created_at": "2026-01-21",
      "tags": ["dates", "DATEDIF", "ANNEE", "MOIS", "JOUR", "FIN.MOIS", "anciennet√©", "√¢ge", "interm√©diaire"],
      "prerequis": ["Formules de base"],
      "ouvre_vers": ["NB.JOURS.OUVRES", "Plannings avanc√©s"]
    }
  }